<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Selective Disclosure for JWTs (SD-JWT)</title>
<meta content="Daniel Fett" name="author">
<meta content="Kristina Yasuda" name="author">
<meta content="
       This document specifies conventions for creating JSON Web Token (JWT)
documents that support selective disclosure of JWT claim values. 
    " name="description">
<meta content="xml2rfc 3.15.2" name="generator">
<meta content="security" name="keyword">
<meta content="oauth2" name="keyword">
<meta content="draft-ietf-oauth-selective-disclosure-jwt-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.15.2
    Python 3.10.8
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.1
    MarkupSafe 2.1.1
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.4.0
    six 1.16.0
    wcwidth 0.2.5
-->
<link href="draft-ietf-oauth-selective-disclosure-jwt.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl > dt {
  float: left;
  margin-right: 1em;
  min-width: 12ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
dl .break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: 14.5px;
}
.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 8em !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([stroke="fill"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SD-JWT</td>
<td class="right">November 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fett &amp; Yasuda</td>
<td class="center">Expires 25 May 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-oauth-selective-disclosure-jwt-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-11-21" class="published">21 November 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-05-25">25 May 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Fett</div>
<div class="org">yes.com</div>
</div>
<div class="author">
      <div class="author-name">K. Yasuda</div>
<div class="org">Microsoft</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Selective Disclosure for JWTs (SD-JWT)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies conventions for creating JSON Web Token (JWT)
documents that support selective disclosure of JWT claim values.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Web Authorization Protocol Working Group mailing list (oauth@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/oauth/">https://mailarchive.ietf.org/arch/browse/oauth/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/oauth-wg/oauth-selective-disclosure-jwt">https://github.com/oauth-wg/oauth-selective-disclosure-jwt</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 25 May 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-feature-summary" class="internal xref">Feature Summary</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terms-and-definitions" class="internal xref">Terms and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-flow-diagram" class="internal xref">Flow Diagram</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-concepts" class="internal xref">Concepts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-creating-an-sd-jwt" class="internal xref">Creating an SD-JWT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-creating-holder-selected-di" class="internal xref">Creating Holder-Selected Disclosures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-optional-holder-binding" class="internal xref">Optional Holder Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-verifying-holder-selected-d" class="internal xref">Verifying Holder-Selected Disclosures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-data-formats" class="internal xref">Data Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-the-challenge-of-canonicali" class="internal xref">The Challenge of Canonicalization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-format-of-an-sd-jwt" class="internal xref">Format of an SD-JWT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-selectively-disclosable-cla" class="internal xref">Selectively Disclosable Claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-digest-derivation-function-" class="internal xref">Digest Derivation Function Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-holder-public-key-claim" class="internal xref">Holder Public Key Claim</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-example-1-sd-jwt" class="internal xref">Example 1: SD-JWT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-combined-format-for-issuanc" class="internal xref">Combined Format for Issuance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-combined-format-for-present" class="internal xref">Combined Format for Presentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-example-combined-format-for" class="internal xref">Example: Combined Format for Presentation for Example 1</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-verification-and-processing" class="internal xref">Verification and Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-verification-by-the-holder" class="internal xref">Verification by the Holder</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-verification-by-the-verifie" class="internal xref">Verification by the Verifier when Receiving SD-JWT and Holder-Selected Disclosures JWT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-processing-model" class="internal xref">Processing Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-mandatory-digest-computatio" class="internal xref">Mandatory digest computation of the revealed claim values by the Verifier</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-mandatory-signing-of-the-sd" class="internal xref">Mandatory signing of the SD-JWT</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-entropy-of-the-salt" class="internal xref">Entropy of the salt</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-minimum-length-of-the-salt" class="internal xref">Minimum length of the salt</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-choice-of-a-digest-derivati" class="internal xref">Choice of a digest derivation algorithm</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-holder-binding" class="internal xref">Holder Binding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-blinding-claim-names" class="internal xref">Blinding Claim Names</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-decoy-digests-2" class="internal xref">Decoy Digests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-claim-names" class="internal xref">Claim Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-unlinkability" class="internal xref">Unlinkability</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-additional-examples" class="internal xref">Additional Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-structured-sd-jwt" class="internal xref">Structured SD-JWT</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.1">
                    <p id="section-toc.1-1.13.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-example-2a-simple-structure" class="internal xref">Example 2a - Simple Structured SD-JWT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.2">
                    <p id="section-toc.1-1.13.2.1.2.2.1"><a href="#appendix-A.1.2" class="auto internal xref">A.1.2</a>.  <a href="#name-example-2b-mixing-sd-and-no" class="internal xref">Example 2b - Mixing SD and Non-SD Claims in a Structured SD-JWT</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1.2.3">
                    <p id="section-toc.1-1.13.2.1.2.3.1"><a href="#appendix-A.1.3" class="auto internal xref">A.1.3</a>.  <a href="#name-example-3-complex-structure" class="internal xref">Example 3 - Complex Structured SD-JWT</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-example-4-w3c-verifiable-cr" class="internal xref">Example 4 - W3C Verifiable Credentials Data Model (work in progress)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-blinding-claim-names-2" class="internal xref">Blinding Claim Names</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3.2.1">
                    <p id="section-toc.1-1.13.2.3.2.1.1"><a href="#appendix-A.3.1" class="auto internal xref">A.3.1</a>.  <a href="#name-example-5-some-blinded-clai" class="internal xref">Example 5: Some Blinded Claims</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3.2.2">
                    <p id="section-toc.1-1.13.2.3.2.2.1"><a href="#appendix-A.3.2" class="auto internal xref">A.3.2</a>.  <a href="#name-example-6-all-claim-names-b" class="internal xref">Example 6: All Claim Names Blinded</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The JSON-based representation of claims in a signed JSON Web Token (JWT) <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> is
secured against modification using JSON Web Signature (JWS) <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> digital
signatures. A consumer of a signed JWT that has checked the
signature can safely assume that the contents of the token have not been
modified.  However, anyone receiving an unencrypted JWT can read all of the
claims and likewise, anyone with the decryption key receiving an encrypted JWT
can also read all of the claims.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">One of the common use cases of a signed JWT is representing a user's
identity. As long as the signed JWT is one-time
use, it typically only contains those claims the user has consented to
disclose to a specific Verifier. However, there is an increasing number
of use cases where a signed JWT is created once and then used a number
of times by the user (the "Holder" of the JWT). In such cases, the signed JWT needs
to contain the superset of all claims the user of the
signed JWT might want to disclose to Verifiers at some point. The
ability to selectively disclose a subset of these claims depending on
the Verifier becomes crucial to ensure minimum disclosure and prevent
Verifiers from obtaining claims irrelevant for the transaction at hand.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">One example of such a multi-use JWT is a verifiable credential, a
tamper-evident credential with a cryptographically verifiable authorship that
contains claims about a subject. SD-JWTs defined in this document enable such
selective disclosure of claims.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">In an SD-JWT, claims can be hidden, but cryptographically protected
against undetected modification. When issuing the SD-JWT to the Holder,
the Issuer also sends the cleartext counterparts of all hidden claims, the so-called
Disclosures, separate from the SD-JWT itself.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The Holder decides which claims to disclose to a Verifier and forwards the respective
Disclosures together with the SD-JWT to the Verifier. The Verifier
has to verify that all disclosed claim values were part of the original,
Issuer-signed SD-JWT. The Verifier will not, however, learn any claim
values not disclosed in the Disclosures.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">While JWTs for claims describing natural persons are a common use case,
the mechanisms defined in this document can be used for many other use
cases as well.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document also describes an optional mechanism for Holder Binding,
or the concept of binding an SD-JWT to key material controlled by the
Holder. The strength of the Holder Binding is conditional upon the trust
in the protection of the private key of the key pair an SD-JWT is bound to.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This specification aims to be easy to implement and to leverage
established and widely used data formats and cryptographic algorithms
wherever possible.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="feature-summary">
<section id="section-1.1">
        <h3 id="name-feature-summary">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-feature-summary" class="section-name selfRef">Feature Summary</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.1-1.1">
            <p id="section-1.1-1.1.1">This specification defines<a href="#section-1.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-1.1.2.1">a format enabling selective disclosure for JWTs,<a href="#section-1.1-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-1.1.2.2">formats for associated data that enables disclosing claims, and<a href="#section-1.1-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-1.1-1.1.2.3">formats for the combined transport of SD-JWTs and the associated data.<a href="#section-1.1-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-1.1-1.2">The specification supports selectively disclosable claims in flat data structures
as well as more complex, nested data structures.<a href="#section-1.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.3">This specification enables combining selectively disclosable claims with
clear-text claims that are always disclosed.<a href="#section-1.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.4">For selectively disclosable claims, claim names are always blinded.<a href="#section-1.1-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-1.2">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2"><strong>base64url</strong> denotes the URL-safe base64 encoding without padding defined in
Section 2 of <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terms-and-definitions">
<section id="section-2">
      <h2 id="name-terms-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-2-1">
        <dt id="section-2-1.1">Selective disclosure:</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.2">Process of a Holder disclosing to a Verifier a subset of claims contained in a claim set issued by an Issuer.<a href="#section-2-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.3">Selectively Disclosable JWT (SD-JWT):</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.4">An Issuer-created signed JWT (JWS, <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>)
that supports selective disclosure as defined in this document and can contain both regular claims and digests of selectively-disclosable claims.<a href="#section-2-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.5">Disclosure:</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.6">A combination of a salt, a cleartext claim name, and a cleartext claim value that is used to calculate a digest for a certain claim.<a href="#section-2-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.7">Holder Binding:</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.8">Ability of the Holder to prove legitimate possession of an SD-JWT by proving
control over the same private key during the issuance and presentation. An SD-JWT with Holder Binding contains
a public key or a reference to a public key that matches to the private key controlled by the Holder.<a href="#section-2-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.9">Issuer:</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.10">An entity that creates SD-JWTs.<a href="#section-2-1.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.11">Holder:</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.12">An entity that received SD-JWTs from the Issuer and has control over them.<a href="#section-2-1.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-1.13">Verifier:</dt>
        <dd style="margin-left: 1.5em" id="section-2-1.14">An entity that requests, checks and extracts the claims from an SD-JWT and respective Disclosures.<a href="#section-2-1.14" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-2-2">Note: discuss if we want to include Client, Authorization Server for the purpose of
ensuring continuity and separating the entity from the actor.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-diagram">
<section id="section-3">
      <h2 id="name-flow-diagram">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-flow-diagram" class="section-name selfRef">Flow Diagram</a>
      </h2>
<span id="name-sd-jwt-issuance-and-present"></span><figure id="figure-1">
        <div id="section-3-1.1">
<pre class="lang-ascii-art sourcecode">           +------------+
           |            |
           |   Issuer   |
           |            |
           +------------+
                 |
             Issues SD-JWT
     and Issuer-Issued Disclosures
                 |
                 v
           +------------+
           |            |
           |   Holder   |
           |            |
           +------------+
                 |
           Presents SD-JWT
   and Holder-Selected Disclosures
                 |
                 v
           +-------------+
           |             |+
           |  Verifiers  ||+
           |             |||
           +-------------+||
            +-------------+|
             +-------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-sd-jwt-issuance-and-present" class="selfRef">SD-JWT Issuance and Presentation Flow</a>
        </figcaption></figure>
</section>
</div>
<div id="concepts">
<section id="section-4">
      <h2 id="name-concepts">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-concepts" class="section-name selfRef">Concepts</a>
      </h2>
<p id="section-4-1">In the following, the contents of SD-JWTs and Disclosures are described at a
conceptual level, abstracting from the data formats described afterwards.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="creating-an-sd-jwt">
<section id="section-4.1">
        <h3 id="name-creating-an-sd-jwt">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-creating-an-sd-jwt" class="section-name selfRef">Creating an SD-JWT</a>
        </h3>
<p id="section-4.1-1">An SD-JWT, at its core, is a digitally signed document containing digests over the claims (per claim: a random salt, the claim name and the claim value).
It MAY further contain clear-text claims that are always disclosed to the Verifier.
It MUST be digitally signed using the Issuer's private key.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>SD-JWT-DOC = (METADATA, SD-CLAIMS, NON-SD-CLAIMS)
SD-JWT = SD-JWT-DOC | SIG(SD-JWT-DOC, ISSUER-PRIV-KEY)
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3"><code>SD-CLAIMS</code> is an object with claim names (<code>CLAIM-NAME</code>) mapped to the digests over the claim values (<code>CLAIM-VALUE</code>) with random salts (<code>SALT</code>). Digests are calculated using a digest derivation function such as a hash function, HMAC, or other (<code>DIGEST-DERIVATION()</code>):<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>SD-CLAIMS = (
    DIGEST-DERIVATION(SALT, CLAIM-NAME, CLAIM-VALUE)
)*
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1-5">When an HMAC or another type of derivation function is used for digest calculation, a secret cryptographic key or other cryptographic secret is used instead of a salt value.
However, the term "salt" is used throughout this document for brevity.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6"><code>SD-CLAIMS</code> can also be nested deeper to capture more complex objects, as will be shown later.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7"><code>SD-JWT</code> is sent from the Issuer to the Holder, together with the mapping of the plain-text claim values, the salt values, and potentially some other information.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">The Issuer further creates a set of Disclosures for all claims in the SD-JWT. The Disclosures are sent to the Holder together with the SD-JWT:<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-9">
<pre>DISCLOSURES = (
    (SALT, CLAIM-NAME, CLAIM-VALUE)
)*
</pre><a href="#section-4.1-9" class="pilcrow">¶</a>
</div>
<p id="section-4.1-10">The SD-JWT and the Disclosures are sent to the Holder by the Issuer:<a href="#section-4.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-11">
<pre>COMBINED-ISSUANCE = (SD-JWT, DISCLOSURES)
</pre><a href="#section-4.1-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="creating-holder-selected-disclosures">
<section id="section-4.2">
        <h3 id="name-creating-holder-selected-di">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-creating-holder-selected-di" class="section-name selfRef">Creating Holder-Selected Disclosures</a>
        </h3>
<p id="section-4.2-1">To disclose to a Verifier a subset of the SD-JWT claim values, a Holder selects a subset of the Disclosures and sends it to the Verifier along with the SD-JWT.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-2">
<pre>HOLDER-SELECTED-DISCLOSURES = (
    (SALT, CLAIM-NAME, CLAIM-VALUE)
)*
</pre><a href="#section-4.2-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>COMBINED-PRESENTATION = SD-JWT | HOLDER-SELECTED-DISCLOSURES
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="optional-holder-binding">
<section id="section-4.3">
        <h3 id="name-optional-holder-binding">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-optional-holder-binding" class="section-name selfRef">Optional Holder Binding</a>
        </h3>
<p id="section-4.3-1">Some use-cases may require Holder Binding.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">If Holder Binding is desired, <code>SD-JWT</code> must contain information about key material controlled by the Holder:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-3">
<pre>SD-JWT-DOC = (METADATA, HOLDER-PUBLIC-KEY, SD-CLAIMS, NON-SD-CLAIMS)
</pre><a href="#section-4.3-3" class="pilcrow">¶</a>
</div>
<p id="section-4.3-4">Note: How the public key is included in SD-JWT is out of scope of this document. It can be passed by value or by reference.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">The Holder can then create a signed document <code>HOLDER-BINDING-JWT</code> using its private key. This document contains some
data provided by the Verifier (out of scope of this document) to ensure the freshness of the signature, for example, a nonce and an indicator of the
intended audience for the document.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-6">
<pre>HOLDER-BINDING-JWT-DOC = (NONCE, AUDIENCE)
HOLDER-BINDING-JWT = HOLDER-BINDING-JWT-DOC |
    SIG(HOLDER-BINDING-JWT-DOC, HOLDER-PRIV-KEY)
</pre><a href="#section-4.3-6" class="pilcrow">¶</a>
</div>
<p id="section-4.3-7">The Holder Binding JWT is sent to the Verifier along with the SD-JWT and the Holder-Selected Disclosures.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-8">
<pre>COMBINED-PRESENTATION = SD-JWT | HOLDER-SELECTED-DISCLOSURES | HOLDER-BINDING-JWT
</pre><a href="#section-4.3-8" class="pilcrow">¶</a>
</div>
<p id="section-4.3-9">Note that there may be other ways to send the Holder Binding JWT to the Verifier or to prove Holder Binding. In these cases, inclusion of the Holder Binding JWT in the <code>COMBINED-PRESENTATION</code> is not required.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifying-holder-selected-disclosures">
<section id="section-4.4">
        <h3 id="name-verifying-holder-selected-d">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-verifying-holder-selected-d" class="section-name selfRef">Verifying Holder-Selected Disclosures</a>
        </h3>
<p id="section-4.4-1">On a high level, the Verifier<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">receives the <code>COMBINED-PRESENTATION</code> from the Holder and verifies the signature of the SD-JWT using the Issuer's public key,<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.2">verifies the Holder Binding JWT, if Holder Binding is required, using the public key included in the SD-JWT,<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.3">calculates the digests over the Holder-Selected Disclosures and verifies that each digest is contained in the SD-JWT.<a href="#section-4.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.4-3">The detailed algorithm is described in <a href="#verifier-verification" class="auto internal xref">Section 6.2</a>.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="data-formats">
<section id="section-5">
      <h2 id="name-data-formats">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-data-formats" class="section-name selfRef">Data Formats</a>
      </h2>
<p id="section-5-1">This section defines data formats for SD-JWTs, Disclosures, Holder Binding JWTs and formats for combining these elements for transport.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="canonicalization">
<section id="section-5.1">
        <h3 id="name-the-challenge-of-canonicali">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-the-challenge-of-canonicali" class="section-name selfRef">The Challenge of Canonicalization</a>
        </h3>
<p id="section-5.1-1">When receiving an SD-JWT with associated Disclosures, a Verifier must
be able to re-compute digests of the disclosed claim values and, given
the same input values, obtain the same digest values as signed by the
Issuer.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Usually, JSON-based formats transport claim values as simple properties of a JSON object such as this:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-3">
<pre>...
  "family_name": "Möbius",
  "address": {
    "street_address": "Schulstr. 12",
    "locality": "Schulpforta"
  }
...
</pre><a href="#section-5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1-4">However, a problem arises when computation over the data need to be performed and verified, like signing or computing digests. Common signature schemes require the same byte string as input to the
signature verification as was used for creating the signature. In the digest derivation approach outlined above, the same problem exists: for the Issuer and the
Verifier to arrive at the same digest, the same byte string must be hashed.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">JSON <span>[<a href="#RFC7159" class="cite xref">RFC7159</a>]</span>, however, does not prescribe a unique encoding for data, but allows for variations in the encoded string. The data above, for example, can be encoded as<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-6">
<pre>...
"family_name": "M\u00f6bius",
"address": {
  "street_address": "Schulstr. 12",
  "locality": "Schulpforta"
}
...
</pre><a href="#section-5.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1-7">or as<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-8">
<pre>...
"family_name": "Möbius",
"address": {"locality":"Schulpforta", "street_address":"Schulstr. 12"}
...
</pre><a href="#section-5.1-8" class="pilcrow">¶</a>
</div>
<p id="section-5.1-9">The two representations <code>"M\u00f6bius"</code> and <code>"M&amp;#246;bius"</code> are very different on the byte-level, but yield
equivalent objects. Same for the representations of <code>address</code>, varying in white space and order of elements in the object.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">The variations in white space, ordering of object properties, and
encoding of Unicode characters are all allowed by the JSON
specification, including further variations, e.g., concerning
floating-point numbers, as described in <span>[<a href="#RFC8785" class="cite xref">RFC8785</a>]</span>. Variations can be
introduced whenever JSON data is serialized or deserialized and unless
dealt with, will lead to different digests and the inability to verify
signatures.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1-11">There are generally two approaches to deal with this problem:<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-12">
<li id="section-5.1-12.1">Canonicalization: The data is transferred in JSON format, potentially
introducing variations in its representation, but is transformed into a
canonical form before computing a digest. Both the Issuer and the Verifier
must use the same canonicalization algorithm to arrive at the same byte
string for computing a digest.<a href="#section-5.1-12.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-12.2">Source string hardening: Instead of transferring data in a format that
may introduce variations, a representation of the data is serialized.
This representation is then used as the digest input at the Verifier,
but also transferred to the Verifier and used for the same digest
calculcation there. This means that the Verifier can easily check the
digest over the byte string before finally deserializing and
accessing the data.<a href="#section-5.1-12.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.1-13">Mixed approaches are conceivable, i.e., transferring both the original JSON data
plus a string suitable for computing a digest, but such approaches can easily lead to
undetected inconsistencies resulting in time-of-check-time-of-use type security
vulnerabilities.<a href="#section-5.1-13" class="pilcrow">¶</a></p>
<p id="section-5.1-14">In this specification, the source string hardening approach is used, as
it allows for simple and reliable interoperability without the
requirement for a canonicalization library. To harden the source string,
any serialization format that supports the necessary data types could
be used in theory, like protobuf, msgpack, or pickle. In this
specification, JSON is used and the JSON document is encoded using base64url-encoding
for transport. This approach means that SD-JWTs can be implemented purely based
on widely available JWT, JSON, and Base64 encoding and decoding libraries.<a href="#section-5.1-14" class="pilcrow">¶</a></p>
<p id="section-5.1-15">A Verifier can then easily check the digest over the source string before
extracting the original JSON data. Variations in the encoding of the source
string are implicitly tolerated by the Verifier, as the digest is computed over a
predefined byte string and not over a JSON object.<a href="#section-5.1-15" class="pilcrow">¶</a></p>
<p id="section-5.1-16">It is important to note that the Disclosures are neither intended nor
suitable for direct consumption by
an application that needs to access the disclosed claim values. The
Disclosures are only intended to be used by a Verifier to check
the digests over the source strings and to extract the original JSON
data. The original JSON data is then used by the application. See
<a href="#processing_model" class="auto internal xref">Section 6.3</a> for details.<a href="#section-5.1-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="format-of-an-sd-jwt">
<section id="section-5.2">
        <h3 id="name-format-of-an-sd-jwt">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-format-of-an-sd-jwt" class="section-name selfRef">Format of an SD-JWT</a>
        </h3>
<p id="section-5.2-1">An SD-JWT is a JWT that MUST be signed using the Issuer's private key. The
payload of an SD-JWT MUST contain the <code>sd_digest_derivation_alg</code> claim
described in the following, MAY contain one or more selectively disclosable claims, and MAY contain a Holder's public key or a reference
thereto, as well as further claims such as <code>iss</code>, <code>iat</code>, etc. as defined or
required by the application using SD-JWTs.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="selectively-disclosable-claims">
<section id="section-5.2.1">
          <h4 id="name-selectively-disclosable-cla">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-selectively-disclosable-cla" class="section-name selfRef">Selectively Disclosable Claims</a>
          </h4>
<p id="section-5.2.1-1">For each claim that is to be selectively disclosed, the Issuer creates a Disclosure object, hashes it, and includes the hash instead of the original claim in the SD-JWT, as described next. The Disclosures are then sent to the Holder.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<div id="creating_disclosures">
<section id="section-5.2.1.1">
            <h5 id="name-creating-disclosures">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-creating-disclosures" class="section-name selfRef">Creating Disclosures</a>
            </h5>
<p id="section-5.2.1.1-1">The Issuer MUST create a Disclosure object for each selectively disclosable claim as follows:<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.1-2.1">
                <p id="section-5.2.1.1-2.1.1">Create an array of three elements in this order:<a href="#section-5.2.1.1-2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1.1-2.1.2">
<li id="section-5.2.1.1-2.1.2.1">A salt value. See <a href="#salt-entropy" class="auto internal xref">Section 7.3</a> and <a href="#salt-minlength" class="auto internal xref">Section 7.4</a> for security considerations. The salt value MUST be unique for each claim that is to be selectively disclosed. It is RECOMMENDED to base64url-encode the salt value, producing a string. Any other type that is allowed in JSON MAY be used, e.g., a number.<a href="#section-5.2.1.1-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-5.2.1.1-2.1.2.2">The claim name, or key, as it would be used in a regular JWT. This MUST be a string.<a href="#section-5.2.1.1-2.1.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-5.2.1.1-2.1.2.3">The claim's value, as it would be used in a regular JWT. The value MAY be of any type that is allowed in JSON, including numbers, strings, booleans, arrays, and objects.<a href="#section-5.2.1.1-2.1.2.3" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li class="normal" id="section-5.2.1.1-2.2">JSON-encode the array such that an UTF-8 string is produced.<a href="#section-5.2.1.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.1-2.3">base64url-encode the byte representation of the UTF-8 string, producing a US-ASCII <span>[<a href="#RFC0020" class="cite xref">RFC0020</a>]</span> string. This string is the Disclosure.<a href="#section-5.2.1.1-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.1.1-3">The following example illustrates the steps described above.<a href="#section-5.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-4">The array is created as follows:<a href="#section-5.2.1.1-4" class="pilcrow">¶</a></p>
<div id="section-5.2.1.1-5">
<pre class="lang-json sourcecode">["6qMQvRL5haj", "family_name", "Möbius"]
</pre><a href="#section-5.2.1.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.1-6">The resulting Disclosure would be <code>WyI2cU1RdlJMNWhhaiIsICJmYW1pbHlfbmFtZSIsICJNw7ZiaXVzIl0</code>.<a href="#section-5.2.1.1-6" class="pilcrow">¶</a></p>
<p id="section-5.2.1.1-7">Note that the JSON encoding of the object is not canonicalized, so variations in white space, encoding
of Unicode characters, and ordering of object properties are allowed. For example, the following strings
are all valid and encode the same claim value:<a href="#section-5.2.1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.1-8.1">A different way to encode the umlaut: <code>WyI2cU1RdlJMNWhhaiIsICJmYW1pbHlfbmFtZSIsICJNXHUwMGY2Yml1cyJd</code><a href="#section-5.2.1.1-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.1-8.2">No white space: <code>WyI2cU1RdlJMNWhhaiIsImZhbWlseV9uYW1lIiwiTcO2Yml1cyJd</code><a href="#section-5.2.1.1-8.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.1-8.3">Newline characters between elements: <code>WwoiNnFNUXZSTDVoYWoiLAoiZmFtaWx5X25hbWUiLAoiTcO2Yml1cyIKXQ</code><a href="#section-5.2.1.1-8.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="hashing-disclosures">
<section id="section-5.2.1.2">
            <h5 id="name-hashing-disclosures">
<a href="#section-5.2.1.2" class="section-number selfRef">5.2.1.2. </a><a href="#name-hashing-disclosures" class="section-name selfRef">Hashing Disclosures</a>
            </h5>
<p id="section-5.2.1.2-1">For embedding the Disclosures in the SD-JWT, the Disclosures are hashed using the digest algorithm specified in the <code>sd_digest_derivation_alg</code> claim described below. The resulting hash is then included in the SD-JWT instead of the original claim value, as described next.<a href="#section-5.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-2">The hash digest MUST be taken over the US-ASCII bytes of the base64url-encoded Disclosure. This follows the convention in JWS <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> and JWE <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>. The bytes of the hash digest MUST then be base64url-encoded.<a href="#section-5.2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.2-3">Note:<a href="#section-5.2.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.2-4.1">The input to the hash function is the base64url-encoded Disclosure, not the bytes encoded by the base64url string.<a href="#section-5.2.1.2-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.2-4.2">The bytes of the output of the hash function are base64url-encoded, not the bytes making up the (often used) hex representation of the bytes of the hash digest.<a href="#section-5.2.1.2-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.1.2-5">For example, the
SHA-256 hash digest of the Disclosure <code>WyI2cU1RdlJMNWhhaiIsICJmYW1pbHlfbmFtZSIsICJNw7ZiaXVzIl0</code> would be
<code>uutlBuYeMDyjLLTpf6Jxi7yNkEF35jdyWMn9U7b_RYY</code>.<a href="#section-5.2.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decoy-digests">
<section id="section-5.2.1.3">
            <h5 id="name-decoy-digests">
<a href="#section-5.2.1.3" class="section-number selfRef">5.2.1.3. </a><a href="#name-decoy-digests" class="section-name selfRef">Decoy Digests</a>
            </h5>
<p id="section-5.2.1.3-1">An Issuer MAY add additional hash digests to the SD-JWT that are not associated with any claim.  The purpose of such "decoy" digests is to make it more difficult for an attacker to see the original number of claims contained in the SD-JWT. It is RECOMMENDED to create the decoy digests by hashing over a cryptographically secure random number. The bytes of the hash digest MUST then be base64url-encoded as above. The same digest function as for the Disclosures MUST be used.<a href="#section-5.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.3-2">For decoy digests, no Disclosure is sent to the Holder, i.e., the Holder will see hash digests that do not correspond to any Disclosure. See <a href="#decoy_digests_privacy" class="auto internal xref">Section 8.1</a> for additional privacy considerations.<a href="#section-5.2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.3-3">To ensure readability and replicability, the examples in this specification do not contain decoy digests unless explicitly stated.<a href="#section-5.2.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="creating-an-sd-jwt-1">
<section id="section-5.2.1.4">
            <h5 id="name-creating-an-sd-jwt-2">
<a href="#section-5.2.1.4" class="section-number selfRef">5.2.1.4. </a><a href="#name-creating-an-sd-jwt-2" class="section-name selfRef">Creating an SD-JWT</a>
            </h5>
<p id="section-5.2.1.4-1">An SD-JWT is a JWT that MUST be signed using the Issuer's private key.<a href="#section-5.2.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.4-2">An SD-JWT MAY contain both selectively disclosable claims and non-selectively disclosable claims, i.e., claims that are always contained in the SD-JWT in plaintext and are always visible to a Verifier.<a href="#section-5.2.1.4-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.4-3">Claims controlling the validity of the SD-JWT, such as <code>iss</code>, <code>exp</code>, or <code>nbf</code> are usually included in plaintext. End-User claims MAY be included as plaintext as well, e.g., if hiding the particular claims from the Verifier does not make sense in the intended use case. Ultimately, an Issuer decides which claims are selectively disclosable and which are not.<a href="#section-5.2.1.4-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.4-4">Plaintext claims are included in the SD-JWT just as they would be in any other JWT.<a href="#section-5.2.1.4-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1.4-5">Selectively disclosable claims are omitted from the SD-JWT. Instead, the hash digests of the respective Disclosures and potentially decoy digests are contained as an array in a new claim, <code>_sd</code>.<a href="#section-5.2.1.4-5" class="pilcrow">¶</a></p>
<p id="section-5.2.1.4-6">The <code>_sd</code> claim MUST be an array of strings, each string being a hash digests of a Disclosure or a decoy digest as described above.
The array MAY be empty, although it is RECOMMENDED to omit the claim in this case to save space.<a href="#section-5.2.1.4-6" class="pilcrow">¶</a></p>
<p id="section-5.2.1.4-7">The Issuer MUST hide the original order of the claims in the array. To ensure this, it is RECOMMENDED to shuffle the array, e.g., by sorting it alphanumerically or randomly. The precise method does not matter as long as it does not depend on the original order of elements.<a href="#section-5.2.1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nested-data-in-sd-jwts">
<section id="section-5.2.1.5">
            <h5 id="name-nested-data-in-sd-jwts">
<a href="#section-5.2.1.5" class="section-number selfRef">5.2.1.5. </a><a href="#name-nested-data-in-sd-jwts" class="section-name selfRef">Nested Data in SD-JWTs</a>
            </h5>
<p id="section-5.2.1.5-1">Just like any JWT, an SD-JWT MAY contain objects that themselves contain other data. For any object in an SD-JWT, the Issuer MAY decide to either make the entire object selectively disclosable or to make its properties selectively disclosable individually. In the latter case, the Issuer MAY even choose to make some some of the object's properties selectively disclosable and others not.<a href="#section-5.2.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5-2">In any case, the <code>_sd</code> claim MUST be included in the SD-JWT at the same level as the original claim and therefore MAY appear multiple times in an SD-JWT.<a href="#section-5.2.1.5-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5-3">The following examples show some of the options an Issuer has when producing an SD-JWT with the following End-User data.<a href="#section-5.2.1.5-3" class="pilcrow">¶</a></p>
<div id="section-5.2.1.5-4">
<pre class="lang-json sourcecode">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "address": {
    "street_address": "Schulstr. 12",
    "locality": "Schulpforta",
    "region": "Sachsen-Anhalte",
    "country": "DE"
  }
}
</pre><a href="#section-5.2.1.5-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5-5">Important: Throughout the examples in this document, line breaks had to
be added to JSON strings and base64-encoded strings (as shown in the
next example) to adhere to the 72 character limit for lines in RFCs and
for readability. JSON does not allow line breaks in strings.<a href="#section-5.2.1.5-5" class="pilcrow">¶</a></p>
<div id="option-1-flat-sd-jwt">
<section id="section-5.2.1.5.1">
              <h6 id="name-option-1-flat-sd-jwt">
<a href="#section-5.2.1.5.1" class="section-number selfRef">5.2.1.5.1. </a><a href="#name-option-1-flat-sd-jwt" class="section-name selfRef">Option 1: Flat SD-JWT</a>
              </h6>
<p id="section-5.2.1.5.1-1">The Issuer can decide to treat the <code>address</code> claim as a block that can either be disclosed completely or not at all. The following example shows that in this case, the entire <code>address</code> claim is treated as an object in the Disclosure.<a href="#section-5.2.1.5.1-1" class="pilcrow">¶</a></p>
<div id="section-5.2.1.5.1-2">
<pre class="lang-json sourcecode">{
  "_sd": [
    "Ha16ca-c-KXYlAcp9VfUL5nZ8yIuneE1sNI3h_swenk"
  ],
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "iss": "https://example.com/issuer",
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256"
}
</pre><a href="#section-5.2.1.5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.1-3">The Issuer would create the following Disclosure:<a href="#section-5.2.1.5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.1-4"><strong>Disclosure for 'address':</strong><a href="#section-5.2.1.5.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.1-5">
<pre>WyJnX0Q5SmtWMjk4UmZBa3gtRHJwQlRBIiwgImFkZHJlc3MiLCB7InN0cmVldF9hZGRy
ZXNzIjogIlNjaHVsc3RyLiAxMiIsICJsb2NhbGl0eSI6ICJTY2h1bHBmb3J0YSIsICJy
ZWdpb24iOiAiU2FjaHNlbi1BbmhhbHRlIiwgImNvdW50cnkiOiAiREUifV0
</pre><a href="#section-5.2.1.5.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.1-6">Contents:<a href="#section-5.2.1.5.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.1-7">
<pre>["g_D9JkV298RfAkx-DrpBTA", "address", {"street_address": "Schulstr.
12", "locality": "Schulpforta", "region": "Sachsen-Anhalte",
"country": "DE"}]
</pre><a href="#section-5.2.1.5.1-7" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.1-8">SHA-256 Hash: <code>Ha16ca-c-KXYlAcp9VfUL5nZ8yIuneE1sNI3h_swenk</code><a href="#section-5.2.1.5.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="option-2-structured-sd-jwt">
<section id="section-5.2.1.5.2">
              <h6 id="name-option-2-structured-sd-jwt">
<a href="#section-5.2.1.5.2" class="section-number selfRef">5.2.1.5.2. </a><a href="#name-option-2-structured-sd-jwt" class="section-name selfRef">Option 2: Structured SD-JWT</a>
              </h6>
<p id="section-5.2.1.5.2-1">The Issuer may instead decide to make the <code>address</code> claim contents selectively disclosable individually:<a href="#section-5.2.1.5.2-1" class="pilcrow">¶</a></p>
<div id="section-5.2.1.5.2-2">
<pre class="lang-json sourcecode">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "address": {
    "_sd": [
      "5GcOWoYSuDtJ6mmwOVBpohx7km5Jn6fqV3EuKjbnx1E",
      "Y9YwGhQiiy6woOi5erWQdHfHT9ZC-WqBWcMaxmiabyo",
      "YVeajj6L3bQvb_uSgWsqi5A9JbWtwszFWbtzlBEMZ1s",
      "i8GJhq3bHnL0RImnEePpgAiKMFWjVhhdXy0u5ksfXIU"
    ]
  },
  "iss": "https://example.com/issuer",
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256"
}
</pre><a href="#section-5.2.1.5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-3">In this case, the Issuer would use the following data in the Disclosures for the <code>address</code> sub-claims:<a href="#section-5.2.1.5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.2-4"><strong>Disclosure for 'street_address':</strong><a href="#section-5.2.1.5.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-5">
<pre>WyJTY3MwWEtrLUVpYmg3bGV3T0pXTmVBIiwgInN0cmVldF9hZGRyZXNzIiwgIlNjaHVs
c3RyLiAxMiJd
</pre><a href="#section-5.2.1.5.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-6">Contents:<a href="#section-5.2.1.5.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-7">
<pre>["Scs0XKk-Eibh7lewOJWNeA", "street_address", "Schulstr. 12"]
</pre><a href="#section-5.2.1.5.2-7" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-8">SHA-256 Hash: <code>i8GJhq3bHnL0RImnEePpgAiKMFWjVhhdXy0u5ksfXIU</code><a href="#section-5.2.1.5.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.2-9"><strong>Disclosure for 'locality':</strong><a href="#section-5.2.1.5.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-10">
<pre>WyJaY1lTYk5jV3BIODdIZ1p1X2J3azB3IiwgImxvY2FsaXR5IiwgIlNjaHVscGZvcnRh
Il0
</pre><a href="#section-5.2.1.5.2-10" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-11">Contents:<a href="#section-5.2.1.5.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-12">
<pre>["ZcYSbNcWpH87HgZu_bwk0w", "locality", "Schulpforta"]
</pre><a href="#section-5.2.1.5.2-12" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-13">SHA-256 Hash: <code>5GcOWoYSuDtJ6mmwOVBpohx7km5Jn6fqV3EuKjbnx1E</code><a href="#section-5.2.1.5.2-13" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.2-14"><strong>Disclosure for 'region':</strong><a href="#section-5.2.1.5.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-15">
<pre>WyJidGNydXFNbHJwSzY4MVBGQVZMNnRRIiwgInJlZ2lvbiIsICJTYWNoc2VuLUFuaGFs
dGUiXQ
</pre><a href="#section-5.2.1.5.2-15" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-16">Contents:<a href="#section-5.2.1.5.2-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-17">
<pre>["btcruqMlrpK681PFAVL6tQ", "region", "Sachsen-Anhalte"]
</pre><a href="#section-5.2.1.5.2-17" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-18">SHA-256 Hash: <code>YVeajj6L3bQvb_uSgWsqi5A9JbWtwszFWbtzlBEMZ1s</code><a href="#section-5.2.1.5.2-18" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.2-19"><strong>Disclosure for 'country':</strong><a href="#section-5.2.1.5.2-19" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-20">
<pre>WyJBUHdBS0NpVWktNlJSSXk5aWNCazBBIiwgImNvdW50cnkiLCAiREUiXQ
</pre><a href="#section-5.2.1.5.2-20" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-21">Contents:<a href="#section-5.2.1.5.2-21" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.2-22">
<pre>["APwAKCiUi-6RRIy9icBk0A", "country", "DE"]
</pre><a href="#section-5.2.1.5.2-22" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.2-23">SHA-256 Hash: <code>Y9YwGhQiiy6woOi5erWQdHfHT9ZC-WqBWcMaxmiabyo</code><a href="#section-5.2.1.5.2-23" class="pilcrow">¶</a></p>
</section>
</div>
<div id="option-3-structured-sd-jwt-only-some-properties-selectively-disclosable">
<section id="section-5.2.1.5.3">
              <h6 id="name-option-3-structured-sd-jwt-">
<a href="#section-5.2.1.5.3" class="section-number selfRef">5.2.1.5.3. </a><a href="#name-option-3-structured-sd-jwt-" class="section-name selfRef">Option 3: Structured SD-JWT, only some properties selectively disclosable</a>
              </h6>
<p id="section-5.2.1.5.3-1">The Issuer may also make one sub-claim of <code>address</code> non-selectively disclosable and hide only the other sub-claims:<a href="#section-5.2.1.5.3-1" class="pilcrow">¶</a></p>
<div id="section-5.2.1.5.3-2">
<pre class="lang-json sourcecode">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "address": {
    "_sd": [
      "BMD-ZCkL825F6P55v7SIUUnczRiP7pGd8nK2vH4iBWo",
      "COuVnjyZqf50HTjQotT4vEXkJrGYRaiFs8_8bdJaNIo",
      "_oY3EClWWHrxSnS_04-lnZv2U2mCc6Hu-NgwBOnLYsY"
    ],
    "country": "DE"
  },
  "iss": "https://example.com/issuer",
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256"
}
</pre><a href="#section-5.2.1.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-3">In this case, the Issuer would issue the following Disclosures:<a href="#section-5.2.1.5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.3-4"><strong>Disclosure for 'street_address':</strong><a href="#section-5.2.1.5.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.3-5">
<pre>WyIxMnV3T0E3TFlHNjRQVUVzbnBaTjNBIiwgInN0cmVldF9hZGRyZXNzIiwgIlNjaHVs
c3RyLiAxMiJd
</pre><a href="#section-5.2.1.5.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-6">Contents:<a href="#section-5.2.1.5.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.3-7">
<pre>["12uwOA7LYG64PUEsnpZN3A", "street_address", "Schulstr. 12"]
</pre><a href="#section-5.2.1.5.3-7" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-8">SHA-256 Hash: <code>_oY3EClWWHrxSnS_04-lnZv2U2mCc6Hu-NgwBOnLYsY</code><a href="#section-5.2.1.5.3-8" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.3-9"><strong>Disclosure for 'locality':</strong><a href="#section-5.2.1.5.3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.3-10">
<pre>WyIwVnJZV2szTHBIS2pWbWVRNnhGRkRRIiwgImxvY2FsaXR5IiwgIlNjaHVscGZvcnRh
Il0
</pre><a href="#section-5.2.1.5.3-10" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-11">Contents:<a href="#section-5.2.1.5.3-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.3-12">
<pre>["0VrYWk3LpHKjVmeQ6xFFDQ", "locality", "Schulpforta"]
</pre><a href="#section-5.2.1.5.3-12" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-13">SHA-256 Hash: <code>BMD-ZCkL825F6P55v7SIUUnczRiP7pGd8nK2vH4iBWo</code><a href="#section-5.2.1.5.3-13" class="pilcrow">¶</a></p>
<p id="section-5.2.1.5.3-14"><strong>Disclosure for 'region':</strong><a href="#section-5.2.1.5.3-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.3-15">
<pre>WyJVenY3T09aNXpublpDLWhtc0p2Rm1nIiwgInJlZ2lvbiIsICJTYWNoc2VuLUFuaGFs
dGUiXQ
</pre><a href="#section-5.2.1.5.3-15" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-16">Contents:<a href="#section-5.2.1.5.3-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.1.5.3-17">
<pre>["Uzv7OOZ5znnZC-hmsJvFmg", "region", "Sachsen-Anhalte"]
</pre><a href="#section-5.2.1.5.3-17" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1.5.3-18">SHA-256 Hash: <code>COuVnjyZqf50HTjQotT4vEXkJrGYRaiFs8_8bdJaNIo</code><a href="#section-5.2.1.5.3-18" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="digest-derivation-function-claim">
<section id="section-5.2.2">
          <h4 id="name-digest-derivation-function-">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-digest-derivation-function-" class="section-name selfRef">Digest Derivation Function Claim</a>
          </h4>
<p id="section-5.2.2-1">The claim <code>sd_digest_derivation_alg</code> indicates the digest derivation algorithm
used by the Issuer to generate the digests over the salts and the
claim values.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">The digest derivation algorithm identifier MUST be one of the following:<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-3.1">a hash algorithm value from the "Hash Name String" column in the IANA "Named Information Hash Algorithm" registry <span>[<a href="#IANA.Hash.Algorithms" class="cite xref">IANA.Hash.Algorithms</a>]</span><a href="#section-5.2.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-3.2">an HMAC algorithm value from the "Algorithmn Name" column in the IANA "JSON Web Signature and Encryption Algorithms" registry <span>[<a href="#IANA.JWS.Algorithms" class="cite xref">IANA.JWS.Algorithms</a>]</span><a href="#section-5.2.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-3.3">a value defined in another specification and/or profile of this specification<a href="#section-5.2.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-4">To promote interoperability, implementations MUST support the SHA-256 hash algorithm.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2-5">See <a href="#security_considerations" class="auto internal xref">Section 7</a> for requirements regarding entropy of the salt, minimum length of the salt, and choice of a digest derivation algorithm.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder-public-key-claim">
<section id="section-5.2.3">
          <h4 id="name-holder-public-key-claim">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-holder-public-key-claim" class="section-name selfRef">Holder Public Key Claim</a>
          </h4>
<p id="section-5.2.3-1">If the Issuer wants to enable Holder Binding, it MAY include a public key
associated with the Holder, or a reference thereto.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">It is out of the scope of this document to describe how the Holder key pair is
established. For example, the Holder MAY provide a key pair to the Issuer,
the Issuer MAY create the key pair for the Holder, or
Holder and Issuer MAY use pre-established key material.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">Note: Examples in this document use <code>cnf</code> Claim defined in <span>[<a href="#RFC7800" class="cite xref">RFC7800</a>]</span> to include raw public key by value in SD-JWT.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="example-1">
<section id="section-5.3">
        <h3 id="name-example-1-sd-jwt">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-example-1-sd-jwt" class="section-name selfRef">Example 1: SD-JWT</a>
        </h3>
<p id="section-5.3-1">This example and Example 2a in <a href="#example-simple-structured-sd-jwt" class="auto internal xref">Appendix A.1.1</a> use the following object as the set
of claims that the Issuer is issuing:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="section-5.3-2">
<pre class="lang-json sourcecode">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "given_name": "John",
  "family_name": "Doe",
  "email": "johndoe@example.com",
  "phone_number": "+1-202-555-0101",
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "birthdate": "1940-01-01"
}
</pre><a href="#section-5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3-3">The following non-normative example shows the payload of an SD-JWT. The Issuer
is using a flat structure, i.e., all of the claims in the <code>address</code> claim can only
be disclosed in full.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div id="section-5.3-4">
<pre class="lang-json sourcecode">{
  "_sd": [
    "6LlIUDMsteqLDUTuSeYbyGfYR3HFwlAuMFprV71uDbk",
    "JNnnsE7gNggbEUi38jM2qv6KTKgzO0EeRG8d2BVQ3Rs",
    "STiegE8aBohuzf07cCcOkvMWKjw-dfHAwkIXeqxN5A8",
    "VDGtd7GETe7AkvIzmTF3iVJsXHvUAErJelozsscllVU",
    "Yrvc0XisV6BOe1ZtWbvNQoD0mw3jBhpkojmHkyGv_ZQ",
    "v-Q-MMj-y-fd6EmPO14RlBZVf3Glc8xTqWYqZdKGyvk",
    "yJarAJIcdhdR2vG-vRzYXGu3feAvxM9vPWuEXPzXY8U"
  ],
  "iss": "https://example.com/issuer",
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256"
}
</pre><a href="#section-5.3-4" class="pilcrow">¶</a>
</div>
<p id="section-5.3-5">The SD-JWT is then signed by the Issuer to create a JWT like the following:<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<div id="section-5.3-6">
<pre class="lang-txt sourcecode">eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZ
UkF6VmRsZnhOMjgwTmdIYUEifQ.eyJfc2QiOiBbIjZMbElVRE1zdGVxTERVVHVTZVlie
UdmWVIzSEZ3bEF1TUZwclY3MXVEYmsiLCAiSk5ubnNFN2dOZ2diRVVpMzhqTTJxdjZLV
Etnek8wRWVSRzhkMkJWUTNScyIsICJTVGllZ0U4YUJvaHV6ZjA3Y0NjT2t2TVdLanctZ
GZIQXdrSVhlcXhONUE4IiwgIlZER3RkN0dFVGU3QWt2SXptVEYzaVZKc1hIdlVBRXJKZ
WxvenNzY2xsVlUiLCAiWXJ2YzBYaXNWNkJPZTFadFdidk5Rb0QwbXczakJocGtvam1Ia
3lHdl9aUSIsICJ2LVEtTU1qLXktZmQ2RW1QTzE0UmxCWlZmM0dsYzh4VHFXWXFaZEtHe
XZrIiwgInlKYXJBSkljZGhkUjJ2Ry12UnpZWEd1M2ZlQXZ4TTl2UFd1RVhQelhZOFUiX
SwgImlzcyI6ICJodHRwczovL2V4YW1wbGUuY29tL2lzc3VlciIsICJpYXQiOiAxNTE2M
jM5MDIyLCAiZXhwIjogMTUxNjI0NzAyMiwgInNkX2RpZ2VzdF9kZXJpdmF0aW9uX2FsZ
yI6ICJzaGEtMjU2In0.KVFIEs0SUWmxNjzn1ETMVUQYnYtZRecOn0nrGSchC6IsJPTpv
grOfk8Ydpv9IIWVoj3d-vQQekM2I6fdGj01f0Wdoj4HREUDM83tGq0-bzcJlzhDN-maq
Iuh4zCYRUGZddbxQqsqaQDLIIBnPoKDldse13TuJlsqMQh5PoFUdkwRg1_oiAjFfv-D1
hynI0zUDtgKs2Ef4lX1Lsv3Je3w3tBOy8UiIqfWtfs6SQxSdDJaC-7SbWR1zgtE6mcoK
Qg9qXJJ9wsdTg7mzKUq4wnsqIoOxaYcRD5YpHvlBdQejtg9GkQTuN-SsDXiSEXV93ClO
Kw7vLZCM0GopE4Q9KHmog
</pre><a href="#section-5.3-6" class="pilcrow">¶</a>
</div>
<p id="section-5.3-7">The Issuer creates the following Disclosures:<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3-8"><strong>Disclosure for 'sub':</strong><a href="#section-5.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-9">
<pre>WyI5V2E2RlFTX2FZSUJuTmE4T1Z6YTZ3IiwgInN1YiIsICI2YzVjMGE0OS1iNTg5LTQz
MWQtYmFlNy0yMTkxMjJhOWVjMmMiXQ
</pre><a href="#section-5.3-9" class="pilcrow">¶</a>
</div>
<p id="section-5.3-10">Contents:<a href="#section-5.3-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-11">
<pre>["9Wa6FQS_aYIBnNa8OVza6w", "sub",
"6c5c0a49-b589-431d-bae7-219122a9ec2c"]
</pre><a href="#section-5.3-11" class="pilcrow">¶</a>
</div>
<p id="section-5.3-12">SHA-256 Hash: <code>v-Q-MMj-y-fd6EmPO14RlBZVf3Glc8xTqWYqZdKGyvk</code><a href="#section-5.3-12" class="pilcrow">¶</a></p>
<p id="section-5.3-13"><strong>Disclosure for 'given_name':</strong><a href="#section-5.3-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-14">
<pre>WyJzbV9jREJPVnV6N0ZfRDNVdGFrcHlRIiwgImdpdmVuX25hbWUiLCAiSm9obiJd
</pre><a href="#section-5.3-14" class="pilcrow">¶</a>
</div>
<p id="section-5.3-15">Contents:<a href="#section-5.3-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-16">
<pre>["sm_cDBOVuz7F_D3UtakpyQ", "given_name", "John"]
</pre><a href="#section-5.3-16" class="pilcrow">¶</a>
</div>
<p id="section-5.3-17">SHA-256 Hash: <code>VDGtd7GETe7AkvIzmTF3iVJsXHvUAErJelozsscllVU</code><a href="#section-5.3-17" class="pilcrow">¶</a></p>
<p id="section-5.3-18"><strong>Disclosure for 'family_name':</strong><a href="#section-5.3-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-19">
<pre>WyJ1RkszcmhIejIyMzZXWHhKczhWd1F3IiwgImZhbWlseV9uYW1lIiwgIkRvZSJd
</pre><a href="#section-5.3-19" class="pilcrow">¶</a>
</div>
<p id="section-5.3-20">Contents:<a href="#section-5.3-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-21">
<pre>["uFK3rhHz2236WXxJs8VwQw", "family_name", "Doe"]
</pre><a href="#section-5.3-21" class="pilcrow">¶</a>
</div>
<p id="section-5.3-22">SHA-256 Hash: <code>yJarAJIcdhdR2vG-vRzYXGu3feAvxM9vPWuEXPzXY8U</code><a href="#section-5.3-22" class="pilcrow">¶</a></p>
<p id="section-5.3-23"><strong>Disclosure for 'email':</strong><a href="#section-5.3-23" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-24">
<pre>WyJCQ3lzYzdzS3lJY0FjMkEycDNzZ1BnIiwgImVtYWlsIiwgImpvaG5kb2VAZXhhbXBs
ZS5jb20iXQ
</pre><a href="#section-5.3-24" class="pilcrow">¶</a>
</div>
<p id="section-5.3-25">Contents:<a href="#section-5.3-25" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-26">
<pre>["BCysc7sKyIcAc2A2p3sgPg", "email", "johndoe@example.com"]
</pre><a href="#section-5.3-26" class="pilcrow">¶</a>
</div>
<p id="section-5.3-27">SHA-256 Hash: <code>STiegE8aBohuzf07cCcOkvMWKjw-dfHAwkIXeqxN5A8</code><a href="#section-5.3-27" class="pilcrow">¶</a></p>
<p id="section-5.3-28"><strong>Disclosure for 'phone_number':</strong><a href="#section-5.3-28" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-29">
<pre>WyJVa1hWam1rUE4ya0xvQ0IyVDR1VThBIiwgInBob25lX251bWJlciIsICIrMS0yMDIt
NTU1LTAxMDEiXQ
</pre><a href="#section-5.3-29" class="pilcrow">¶</a>
</div>
<p id="section-5.3-30">Contents:<a href="#section-5.3-30" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-31">
<pre>["UkXVjmkPN2kLoCB2T4uU8A", "phone_number", "+1-202-555-0101"]
</pre><a href="#section-5.3-31" class="pilcrow">¶</a>
</div>
<p id="section-5.3-32">SHA-256 Hash: <code>Yrvc0XisV6BOe1ZtWbvNQoD0mw3jBhpkojmHkyGv_ZQ</code><a href="#section-5.3-32" class="pilcrow">¶</a></p>
<p id="section-5.3-33"><strong>Disclosure for 'address':</strong><a href="#section-5.3-33" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-34">
<pre>WyJuYkFNc2VEZHRJaVRJSTIwNU1RVjZ3IiwgImFkZHJlc3MiLCB7InN0cmVldF9hZGRy
ZXNzIjogIjEyMyBNYWluIFN0IiwgImxvY2FsaXR5IjogIkFueXRvd24iLCAicmVnaW9u
IjogIkFueXN0YXRlIiwgImNvdW50cnkiOiAiVVMifV0
</pre><a href="#section-5.3-34" class="pilcrow">¶</a>
</div>
<p id="section-5.3-35">Contents:<a href="#section-5.3-35" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-36">
<pre>["nbAMseDdtIiTII205MQV6w", "address", {"street_address": "123 Main
St", "locality": "Anytown", "region": "Anystate", "country": "US"}]
</pre><a href="#section-5.3-36" class="pilcrow">¶</a>
</div>
<p id="section-5.3-37">SHA-256 Hash: <code>JNnnsE7gNggbEUi38jM2qv6KTKgzO0EeRG8d2BVQ3Rs</code><a href="#section-5.3-37" class="pilcrow">¶</a></p>
<p id="section-5.3-38"><strong>Disclosure for 'birthdate':</strong><a href="#section-5.3-38" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-39">
<pre>WyIzZ28zOTYtUDFiNXVyZVR6N3BnTDl3IiwgImJpcnRoZGF0ZSIsICIxOTQwLTAxLTAx
Il0
</pre><a href="#section-5.3-39" class="pilcrow">¶</a>
</div>
<p id="section-5.3-40">Contents:<a href="#section-5.3-40" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-41">
<pre>["3go396-P1b5ureTz7pgL9w", "birthdate", "1940-01-01"]
</pre><a href="#section-5.3-41" class="pilcrow">¶</a>
</div>
<p id="section-5.3-42">SHA-256 Hash: <code>6LlIUDMsteqLDUTuSeYbyGfYR3HFwlAuMFprV71uDbk</code><a href="#section-5.3-42" class="pilcrow">¶</a></p>
</section>
</div>
<div id="combined-format-for-issuance">
<section id="section-5.4">
        <h3 id="name-combined-format-for-issuanc">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-combined-format-for-issuanc" class="section-name selfRef">Combined Format for Issuance</a>
        </h3>
<p id="section-5.4-1">Besides the SD-JWT itself, the Holder needs to learn the raw claim values that
are contained in the SD-JWT, along with the precise input to the digest
calculation and the salts. To this end, the Issuer sends the Disclosure objects
that were also used for the hash calculation, as described in <a href="#creating_disclosures" class="auto internal xref">Section 5.2.1.1</a>,
to the Holder.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The data format for sending the SD-JWT and the Disclosures to the Holder is
as follows:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-3">
<pre>&lt;SD-JWT&gt;~&lt;Disclosure 1&gt;~&lt;Disclosure 2&gt;~...~&lt;Disclosure N&gt;
</pre><a href="#section-5.4-3" class="pilcrow">¶</a>
</div>
<p id="section-5.4-4">This is called the Combined Format for Issuance.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">The Disclosures and SD-JWT are implicitly linked through the
digest values of the Disclosures included in the SD-JWT.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">For Example 1, the Combined Format for Issuance looks as follows:<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<div id="section-5.4-7">
<pre class="lang-txt sourcecode">eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZ
UkF6VmRsZnhOMjgwTmdIYUEifQ.eyJfc2QiOiBbIjZMbElVRE1zdGVxTERVVHVTZVlie
UdmWVIzSEZ3bEF1TUZwclY3MXVEYmsiLCAiSk5ubnNFN2dOZ2diRVVpMzhqTTJxdjZLV
Etnek8wRWVSRzhkMkJWUTNScyIsICJTVGllZ0U4YUJvaHV6ZjA3Y0NjT2t2TVdLanctZ
GZIQXdrSVhlcXhONUE4IiwgIlZER3RkN0dFVGU3QWt2SXptVEYzaVZKc1hIdlVBRXJKZ
WxvenNzY2xsVlUiLCAiWXJ2YzBYaXNWNkJPZTFadFdidk5Rb0QwbXczakJocGtvam1Ia
3lHdl9aUSIsICJ2LVEtTU1qLXktZmQ2RW1QTzE0UmxCWlZmM0dsYzh4VHFXWXFaZEtHe
XZrIiwgInlKYXJBSkljZGhkUjJ2Ry12UnpZWEd1M2ZlQXZ4TTl2UFd1RVhQelhZOFUiX
SwgImlzcyI6ICJodHRwczovL2V4YW1wbGUuY29tL2lzc3VlciIsICJpYXQiOiAxNTE2M
jM5MDIyLCAiZXhwIjogMTUxNjI0NzAyMiwgInNkX2RpZ2VzdF9kZXJpdmF0aW9uX2FsZ
yI6ICJzaGEtMjU2In0.KVFIEs0SUWmxNjzn1ETMVUQYnYtZRecOn0nrGSchC6IsJPTpv
grOfk8Ydpv9IIWVoj3d-vQQekM2I6fdGj01f0Wdoj4HREUDM83tGq0-bzcJlzhDN-maq
Iuh4zCYRUGZddbxQqsqaQDLIIBnPoKDldse13TuJlsqMQh5PoFUdkwRg1_oiAjFfv-D1
hynI0zUDtgKs2Ef4lX1Lsv3Je3w3tBOy8UiIqfWtfs6SQxSdDJaC-7SbWR1zgtE6mcoK
Qg9qXJJ9wsdTg7mzKUq4wnsqIoOxaYcRD5YpHvlBdQejtg9GkQTuN-SsDXiSEXV93ClO
Kw7vLZCM0GopE4Q9KHmog~WyI5V2E2RlFTX2FZSUJuTmE4T1Z6YTZ3IiwgInN1YiIsIC
I2YzVjMGE0OS1iNTg5LTQzMWQtYmFlNy0yMTkxMjJhOWVjMmMiXQ~WyJzbV9jREJPVnV
6N0ZfRDNVdGFrcHlRIiwgImdpdmVuX25hbWUiLCAiSm9obiJd~WyJ1RkszcmhIejIyMz
ZXWHhKczhWd1F3IiwgImZhbWlseV9uYW1lIiwgIkRvZSJd~WyJCQ3lzYzdzS3lJY0FjM
kEycDNzZ1BnIiwgImVtYWlsIiwgImpvaG5kb2VAZXhhbXBsZS5jb20iXQ~WyJVa1hWam
1rUE4ya0xvQ0IyVDR1VThBIiwgInBob25lX251bWJlciIsICIrMS0yMDItNTU1LTAxMD
EiXQ~WyJuYkFNc2VEZHRJaVRJSTIwNU1RVjZ3IiwgImFkZHJlc3MiLCB7InN0cmVldF9
hZGRyZXNzIjogIjEyMyBNYWluIFN0IiwgImxvY2FsaXR5IjogIkFueXRvd24iLCAicmV
naW9uIjogIkFueXN0YXRlIiwgImNvdW50cnkiOiAiVVMifV0~WyIzZ28zOTYtUDFiNXV
yZVR6N3BnTDl3IiwgImJpcnRoZGF0ZSIsICIxOTQwLTAxLTAxIl0
</pre><a href="#section-5.4-7" class="pilcrow">¶</a>
</div>
<p id="section-5.4-8">(Line breaks for presentation only.)<a href="#section-5.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="combined-format-for-presentation">
<section id="section-5.5">
        <h3 id="name-combined-format-for-present">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-combined-format-for-present" class="section-name selfRef">Combined Format for Presentation</a>
        </h3>
<p id="section-5.5-1">For presentation to a Verifier, the Holder sends the SD-JWT and a selected
subset of the Disclosures to the Verifier.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">The data format for sending the SD-JWT and the Disclosures to the Verifier is
as follows (line break added for readability):<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5-3">
<pre>&lt;SD-JWT&gt;~&lt;Disclosure 1&gt;~&lt;Disclosure 2&gt;~...~&lt;Disclosure M&gt;~&lt;optional Holder Binding JWT&gt;
</pre><a href="#section-5.5-3" class="pilcrow">¶</a>
</div>
<p id="section-5.5-4">This is called the Combined Format for Presentation.<a href="#section-5.5-4" class="pilcrow">¶</a></p>
<p id="section-5.5-5">The Holder MAY send any subset of the Disclosures to the Verifier, i.e.,
none, multiple, or all Disclosures.<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<p id="section-5.5-6">The Holder MAY add an optional JWT to prove Holder Binding to the Verifier.
The precise contents of the JWT are out of scope of this specification.
Usually, a <code>nonce</code> and <code>aud</code> claim are included to show that the proof is
intended for the Verifier and to prevent replay attacks. How the <code>nonce</code> or
other claims are obtained by the Holder is out of scope of this specification.<a href="#section-5.5-6" class="pilcrow">¶</a></p>
<p id="section-5.5-7">Whether to require Holder Binding is up to the Verifier's policy,
based on the set of trust requirements such as trust frameworks it belongs to.<a href="#section-5.5-7" class="pilcrow">¶</a></p>
<p id="section-5.5-8">Other ways of proving Holder Binding are possible, e.g., when the Combined Format
for Presentation is itself embedded in a signed JWT.<a href="#section-5.5-8" class="pilcrow">¶</a></p>
<p id="section-5.5-9">If no Holder Binding JWT is included, the Combined Format for Presentation ends with
the <code>~</code> character after the last Disclosure.<a href="#section-5.5-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-combined-format-for-presentation-for-example-1">
<section id="section-5.6">
        <h3 id="name-example-combined-format-for">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-example-combined-format-for" class="section-name selfRef">Example: Combined Format for Presentation for Example 1</a>
        </h3>
<p id="section-5.6-1">The following is a non-normative example of the contents of a Presentation for Example 1, disclosing
the claims <code>given_name</code>, <code>family_name</code>, and <code>address</code>:<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<div id="section-5.6-2">
<pre class="lang-txt sourcecode">eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZ
UkF6VmRsZnhOMjgwTmdIYUEifQ.eyJfc2QiOiBbIjZMbElVRE1zdGVxTERVVHVTZVlie
UdmWVIzSEZ3bEF1TUZwclY3MXVEYmsiLCAiSk5ubnNFN2dOZ2diRVVpMzhqTTJxdjZLV
Etnek8wRWVSRzhkMkJWUTNScyIsICJTVGllZ0U4YUJvaHV6ZjA3Y0NjT2t2TVdLanctZ
GZIQXdrSVhlcXhONUE4IiwgIlZER3RkN0dFVGU3QWt2SXptVEYzaVZKc1hIdlVBRXJKZ
WxvenNzY2xsVlUiLCAiWXJ2YzBYaXNWNkJPZTFadFdidk5Rb0QwbXczakJocGtvam1Ia
3lHdl9aUSIsICJ2LVEtTU1qLXktZmQ2RW1QTzE0UmxCWlZmM0dsYzh4VHFXWXFaZEtHe
XZrIiwgInlKYXJBSkljZGhkUjJ2Ry12UnpZWEd1M2ZlQXZ4TTl2UFd1RVhQelhZOFUiX
SwgImlzcyI6ICJodHRwczovL2V4YW1wbGUuY29tL2lzc3VlciIsICJpYXQiOiAxNTE2M
jM5MDIyLCAiZXhwIjogMTUxNjI0NzAyMiwgInNkX2RpZ2VzdF9kZXJpdmF0aW9uX2FsZ
yI6ICJzaGEtMjU2In0.KVFIEs0SUWmxNjzn1ETMVUQYnYtZRecOn0nrGSchC6IsJPTpv
grOfk8Ydpv9IIWVoj3d-vQQekM2I6fdGj01f0Wdoj4HREUDM83tGq0-bzcJlzhDN-maq
Iuh4zCYRUGZddbxQqsqaQDLIIBnPoKDldse13TuJlsqMQh5PoFUdkwRg1_oiAjFfv-D1
hynI0zUDtgKs2Ef4lX1Lsv3Je3w3tBOy8UiIqfWtfs6SQxSdDJaC-7SbWR1zgtE6mcoK
Qg9qXJJ9wsdTg7mzKUq4wnsqIoOxaYcRD5YpHvlBdQejtg9GkQTuN-SsDXiSEXV93ClO
Kw7vLZCM0GopE4Q9KHmog~WyJuYkFNc2VEZHRJaVRJSTIwNU1RVjZ3IiwgImFkZHJlc3
MiLCB7InN0cmVldF9hZGRyZXNzIjogIjEyMyBNYWluIFN0IiwgImxvY2FsaXR5IjogIk
FueXRvd24iLCAicmVnaW9uIjogIkFueXN0YXRlIiwgImNvdW50cnkiOiAiVVMifV0~Wy
JzbV9jREJPVnV6N0ZfRDNVdGFrcHlRIiwgImdpdmVuX25hbWUiLCAiSm9obiJd~WyJ1R
kszcmhIejIyMzZXWHhKczhWd1F3IiwgImZhbWlseV9uYW1lIiwgIkRvZSJd~
</pre><a href="#section-5.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verification-and-processing">
<section id="section-6">
      <h2 id="name-verification-and-processing">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-verification-and-processing" class="section-name selfRef">Verification and Processing</a>
      </h2>
<div id="holder-verification">
<section id="section-6.1">
        <h3 id="name-verification-by-the-holder">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-verification-by-the-holder" class="section-name selfRef">Verification by the Holder</a>
        </h3>
<p id="section-6.1-1">The Holder MUST perform the following (or equivalent) steps when receiving
a Combined Format for Issuance:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-2">
<li id="section-6.1-2.1">Separate the SD-JWT and the Disclosures in the Combined Format for Issuance.<a href="#section-6.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.2">Hash all of the Disclosures separately.<a href="#section-6.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.3">Find the places in the SD-JWT where the digests of the Disclosures are
included.<a href="#section-6.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.4">Decide which Disclosures to release to the Verifier, obtaining proper End-User consent if necessary.<a href="#section-6.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.5">If Holder Binding is required, create a Holder Binding JWT.<a href="#section-6.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-2.6">Create the Combined Format for Presentation, including the selected Disclosures and, if applicable, the Holder Binding JWT.<a href="#section-6.1-2.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="verifier-verification">
<section id="section-6.2">
        <h3 id="name-verification-by-the-verifie">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-verification-by-the-verifie" class="section-name selfRef">Verification by the Verifier when Receiving SD-JWT and Holder-Selected Disclosures JWT</a>
        </h3>
<p id="section-6.2-1">Verifiers MUST follow <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span> for checking the SD-JWT and, if signed, the
Disclosures JWT.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Verifiers MUST go through (at least) the following steps before
trusting/using any of the contents of an SD-JWT:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3">
<li id="section-6.2-3.1">Determine if Holder Binding is to be checked according to the Verifier's policy
for the use case at hand. This decision MUST NOT be based on whether
the HS-Disclosures
JWT is signed or not. Refer to <a href="#holder_binding_security" class="auto internal xref">Section 7.6</a> for
details.<a href="#section-6.2-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-3.2">Check that the presentation consists of six period-separated (<code>.</code>) elements; if Holder Binding is not required, the last element can be empty.<a href="#section-6.2-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-3.3">Separate the SD-JWT from the HS-Disclosures JWT.<a href="#section-6.2-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-3.4">
            <p id="section-6.2-3.4.1">Validate the SD-JWT:<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.4.2">
<li id="section-6.2-3.4.2.1">Ensure that a signing algorithm was used that was deemed secure for the application. Refer to <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, Sections 3.1 and 3.2 for details. <code>none</code> MUST NOT be accepted.<a href="#section-6.2-3.4.2.1" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-3.4.2.2">Validate the signature over the SD-JWT.<a href="#section-6.2-3.4.2.2" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-3.4.2.3">Validate the Issuer of the SD-JWT and that the signing key belongs to this Issuer.<a href="#section-6.2-3.4.2.3" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-3.4.2.4">Check that the SD-JWT is valid using <code>nbf</code>, <code>iat</code>, and <code>exp</code> claims, if provided in the SD-JWT.<a href="#section-6.2-3.4.2.4" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-3.4.2.5">Check that the claim <code>sd_digests</code> is present in the SD-JWT.<a href="#section-6.2-3.4.2.5" class="pilcrow">¶</a>
</li>
              <li id="section-6.2-3.4.2.6">Check that the <code>sd_digest_derivation_alg</code> claim is present and its value is understood and the digest derivation algorithm is deemed secure.<a href="#section-6.2-3.4.2.6" class="pilcrow">¶</a>
</li>
            </ol>
</li>
          <li id="section-6.2-3.5">
            <p id="section-6.2-3.5.1">Validate the HS-Disclosures JWT:<a href="#section-6.2-3.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.5.2">
<li id="section-6.2-3.5.2.1">
                <p id="section-6.2-3.5.2.1.1">If Holder Binding is required, validate the signature over the HS-Disclosures JWT using the same steps as for the SD-JWT plus the following steps:<a href="#section-6.2-3.5.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-3.5.2.1.2">
<li id="section-6.2-3.5.2.1.2.1">Determine that the public key for the private key that used to sign the HS-Disclosures JWT is bound to the SD-JWT, i.e., the SD-JWT either contains a reference to the public key or contains the public key itself.<a href="#section-6.2-3.5.2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-6.2-3.5.2.1.2.2">Determine that the HS-Disclosures JWT is bound to the current transaction and was created for this Verifier (replay protection). This is usually achieved by a <code>nonce</code> and <code>aud</code> field within the HS-Disclosures JWT.<a href="#section-6.2-3.5.2.1.2.2" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-6.2-3.5.2.2">
                <p id="section-6.2-3.5.2.2.1">For each claim in <code>sd_hs_disclosures</code> in the HS-Disclosures JWT:<a href="#section-6.2-3.5.2.2.1" class="pilcrow">¶</a></p>
<ol start="3" type="1" class="normal type-1" id="section-6.2-3.5.2.2.2">
<li id="section-6.2-3.5.2.2.2.1">Ensure that the claim is present as well in <code>sd_digests</code> in the SD-JWT.
If <code>sd_digests</code> is structured, the claim MUST be present at the same
place within the structure.<a href="#section-6.2-3.5.2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-6.2-3.5.2.2.2.2">Compute the base64url-encoded digest of the JSON literal disclosed
by the Holder using the <code>sd_digest_derivation_alg</code> in SD-JWT.<a href="#section-6.2-3.5.2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-6.2-3.5.2.2.2.3">Compare the digests computed in the previous step with the one of
the same claim in the SD-JWT. Accept the claim only when the two
digests match.<a href="#section-6.2-3.5.2.2.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-6.2-3.5.2.2.2.4">Ensure that the claim value in the HS-Disclosures JWT is a JSON-encoded
object containing at least the keys <code>s</code> and <code>v</code>, and optionally <code>n</code>.<a href="#section-6.2-3.5.2.2.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-6.2-3.5.2.2.2.5">Store the value of the key <code>v</code> as the claim value. If <code>n</code> is contained
in the object, use the value of the key <code>n</code> as the claim name.<a href="#section-6.2-3.5.2.2.2.5" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-6.2-3.5.2.3">Once all necessary claims have been verified, their values can be
validated and used according to the requirements of the application. It
MUST be ensured that all claims required for the application have been
disclosed.<a href="#section-6.2-3.5.2.3" class="pilcrow">¶</a>
</li>
            </ol>
</li>
        </ol>
<p id="section-6.2-4">If any step fails, the input is not valid and processing MUST be aborted.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing_model">
<section id="section-6.3">
        <h3 id="name-processing-model">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-processing-model" class="section-name selfRef">Processing Model</a>
        </h3>
<p id="section-6.3-1">Neither an SD-JWT nor an HS-Disclosures JWT is suitable for direct use by an application.
Besides the REQUIRED verification steps listed above, it is further RECOMMENDED
that an application-consumable format is generated from the data released in
the HS-Disclosures. The RECOMMENDED way is to merge the released claims and any
plaintext claims in the SD-JWT recursively:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">Objects from the released claims must be merged into existing objects from the SD-JWT.<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">If a key is present in both objects:<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.2.2.1">If the value in the released claims is an object and the value in the
SD-JWT claims is an object, the two objects MUST be merged recursively.<a href="#section-6.3-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.3-2.2.2.2">Else, the value in the released claims MUST be used.<a href="#section-6.3-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-6.3-3">The keys <code>sd_digests</code> and <code>sd_digest_derivation_alg</code> SHOULD be removed prior to further
processing.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">The processing is shown in Examples 2b and 3 in the Appendix.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security_considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="mandatory-digest-computation-of-the-revealed-claim-values-by-the-verifier">
<section id="section-7.1">
        <h3 id="name-mandatory-digest-computatio">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-mandatory-digest-computatio" class="section-name selfRef">Mandatory digest computation of the revealed claim values by the Verifier</a>
        </h3>
<p id="section-7.1-1">ToDo: add text explaining mechanisms that should be adopted to ensure that
  Verifiers validate the claim values received in HS-Disclosures JWT by calculating the
  digests of those values and comparing them with the digests in the SD-JWT:
  - create a test suite that forces digest computation by the Verifiers,
    and includes negative test cases in test vectors
  - use only implementations/libraries that are compliant to the test suite
  - etc.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mandatory-signing-of-the-sd-jwt">
<section id="section-7.2">
        <h3 id="name-mandatory-signing-of-the-sd">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mandatory-signing-of-the-sd" class="section-name selfRef">Mandatory signing of the SD-JWT</a>
        </h3>
<p id="section-7.2-1">The SD-JWT MUST be signed by the Issuer to protect integrity of the issued
claims. An attacker can modify or add claims if an SD-JWT is not signed (e.g.,
change the "email" attribute to take over the victim's account or add an
attribute indicating a fake academic qualification).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The Verifier MUST always check the SD-JWT signature to ensure that the SD-JWT
has not been tampered with since its issuance. If the signature on the SD-JWT
cannot be verified, the SD-JWT MUST be rejected.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="salt-entropy">
<section id="section-7.3">
        <h3 id="name-entropy-of-the-salt">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-entropy-of-the-salt" class="section-name selfRef">Entropy of the salt</a>
        </h3>
<p id="section-7.3-1">The security model relies on the fact that the salt is not learned or guessed by
the attacker. It is vitally important to adhere to this principle. As such, the
salt MUST be created in such a manner that it is cryptographically random,
long enough and has high entropy that it is not practical for the attacker to
guess. A new salt MUST be chosen for each claim.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="salt-minlength">
<section id="section-7.4">
        <h3 id="name-minimum-length-of-the-salt">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-minimum-length-of-the-salt" class="section-name selfRef">Minimum length of the salt</a>
        </h3>
<p id="section-7.4-1">The RECOMMENDED minimum length of the randomly-generated portion of the salt is 128 bits.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">Note that minimum 128 bits would be necessary when SHA-256, HMAC-SHA256, or a function of similar strength is used, but a smaller salt size might achieve similar level of security if a stronger iterative derivation function is used.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">The Issuer MUST ensure that a new salt value is chosen for each claim,
including when the same claim name occurs at different places in the
structure of the SD-JWT. This can be seen in Example 3 in the Appendix,
where multiple claims with the name <code>type</code> appear, but each of them has
a different salt.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-a-digest-derivation-algorithm">
<section id="section-7.5">
        <h3 id="name-choice-of-a-digest-derivati">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-choice-of-a-digest-derivati" class="section-name selfRef">Choice of a digest derivation algorithm</a>
        </h3>
<p id="section-7.5-1">For the security of this scheme, the digest derivation algorithm is required to be preimage and collision
resistant, i.e., it is infeasible to calculate the salt and claim value that result in
a particular digest, and it is infeasible to find a different salt and claim value pair that
result in a matching digest, respectively.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">Furthermore the hash algorithms MD2, MD4, MD5, RIPEMD-160, and SHA-1
revealed fundamental weaknesses and they MUST NOT be used.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="holder_binding_security">
<section id="section-7.6">
        <h3 id="name-holder-binding">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-holder-binding" class="section-name selfRef">Holder Binding</a>
        </h3>
<p id="section-7.6-1">Verifiers MUST decide whether Holder Binding is required for a
particular use case or not before verifying a credential. This decision
can be informed by various factors including, but not limited to the following:
business requirements, the use case, the type of
binding between a Holder and its credential that is required for a use
case, the sensitivity of the use case, the expected properties of a
credential, the type and contents of other credentials expected to be
presented at the same time, etc.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">This can be showcased based on two scenarios for a mobile driver's license use case for SD-JWT:<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3"><strong>Scenario A:</strong> For the verification of the driver's license when
stopped by a police officer for exceeding a speed limit, Holder Binding may be necessary to ensure that the person
driving the car and presenting the license is the actual Holder of the
license. The Verifier (e.g., the software used by the police officer)
will ensure that the HS-Disclosures JWT is signed by the Holder's private
key.<a href="#section-7.6-3" class="pilcrow">¶</a></p>
<p id="section-7.6-4"><strong>Scenario B:</strong> A rental car agency may want to ensure, for insurance
purposes, that all drivers named on the rental contract own a
government-issued driver's license. The signer of the rental contract
can present the mobile driver's license of all named drivers. In this
case, the rental car agency does not need to check Holder Binding as the
goal is not to verify the identity of the person presenting the license,
but to verify that a license exists and is valid.<a href="#section-7.6-4" class="pilcrow">¶</a></p>
<p id="section-7.6-5">It is important that a Verifier does not make its security policy
decisions based on data that can be influenced by an attacker or that
can be misinterpreted. For this reason, when deciding whether Holder
binding is required or not, Verifiers MUST NOT take into account<a href="#section-7.6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6-6.1">whether an HS-Disclosure JWT is signed or not, as an attacker can
remove the signature from any HS-Disclosure JWT and present it to the
Verifier, or<a href="#section-7.6-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.6-6.2">whether a key reference is present in the SD-JWT or not, as the
Issuer might have added the key to the SD-JWT in a format/claim that
is not recognized by the Verifier.<a href="#section-7.6-6.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.6-7">If a Verifier has decided that Holder Binding is required for a
particular use case and the HS-Disclosure is unsigned or no recognized
key reference is present in the SD-JWT, the Verifier will reject the
presentation, as described in <a href="#verifier-verification" class="auto internal xref">Section 6.2</a>.<a href="#section-7.6-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="blinding-claim-names">
<section id="section-7.7">
        <h3 id="name-blinding-claim-names">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-blinding-claim-names" class="section-name selfRef">Blinding Claim Names</a>
        </h3>
<p id="section-7.7-1">Issuers that chose to blind claim names MUST ensure not to inadvertently leak
information about the blinded claim names to Verifiers.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
<p id="section-7.7-2">It is RECOMMENDED to use cryptographically random numbers with at least 128 bits
of entropy as placeholder claim names.<a href="#section-7.7-2" class="pilcrow">¶</a></p>
<p id="section-7.7-3">The order of elements in JSON-encoded objects is generally not relevant
to applications, but it may reveal information about a blinded claim
name to the verifier. For example, assume the following two clear-text
claim sets created by the same Issuer:<a href="#section-7.7-3" class="pilcrow">¶</a></p>
<p id="section-7.7-4">(A)<a href="#section-7.7-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.7-5">
<pre>{
  "given_name": "Doe",
  "secret_club_membership_no": 42
}
</pre><a href="#section-7.7-5" class="pilcrow">¶</a>
</div>
<p id="section-7.7-6">(B)<a href="#section-7.7-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.7-7">
<pre>{
  "is_secret_agent": true,
  "given_name": "Doe"
}
</pre><a href="#section-7.7-7" class="pilcrow">¶</a>
</div>
<p id="section-7.7-8">When naively blinding the claim names, the order of the elements might
be preserved in the SD-JWT (depending on implementation details of the
programming language):<a href="#section-7.7-8" class="pilcrow">¶</a></p>
<p id="section-7.7-9">(A)<a href="#section-7.7-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.7-10">
<pre>{
  "given_name": "Doe",
  "3DOgmo7w7MDZNh1Zjvmwpg":
    "OXZKGG7Ltar4vz_L7sAtWIkVXVf5r9xONFKZdyoNlco"
}
</pre><a href="#section-7.7-10" class="pilcrow">¶</a>
</div>
<p id="section-7.7-11">(B)<a href="#section-7.7-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.7-12">
<pre>{
  "CwiB46IUgi4NydIfgGTRwg":
    "4miZg7O_JaidVJyjGiPpc4FXAMN16e1SBZfOMlYg3hQ",
  "given_name": "Doe"
}
</pre><a href="#section-7.7-12" class="pilcrow">¶</a>
</div>
<p id="section-7.7-13">A verifier, even if it does not learn any blinded claim names, can
distinguish what claim name has been hidden just by observing the order
of blinded and unblinded claim names. It is therefore RECOMMENDED, if at
least one claim name is blinded, to either<a href="#section-7.7-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7-14.1">randomize the order of all claims (blinded/unblinded, selectively disclosed/not-selectively disclosed),<a href="#section-7.7-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.7-14.2">or sort the claims by the property name (i.e., the placeholder claim
name for blinded claim names and the plaintext claim name for
unblinded claim names). The precise order does not matter. For
example, ordering by unicode code points or by lexicographic order is
sufficient to hide the original order of claims.<a href="#section-7.7-14.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.7-15">This applies to Issuers (SD-JWT and Disclosures document) and
Holders (HS-Disclosures JWT).<a href="#section-7.7-15" class="pilcrow">¶</a></p>
<p id="section-7.7-16">With the approach chosen in this specification, claim names of objects
that are not themselves selectively disclosable are not blinded.  This
can be seen in Example 6 in the Appendix, where even in the blinded
SD-JWT, <code>address</code> and <code>delivery_address</code> are visible. This limitation
needs to be taken into account by Issuers when creating the structure of
the SD-JWT.<a href="#section-7.7-16" class="pilcrow">¶</a></p>
<p id="section-7.7-17">The Issuer MUST ensure that a new random placeholder name is chosen for
each claim, including when the same claim name occurs at different
places in the structure of the SD-JWT. This can be seen in Example 6 in
the Appendix, where multiple claims with same name appear below
<code>address</code> and <code>delivery_address</code>, but each of them has a different
blinded claim name. For each credential issued, new random placeholder names
MUST be chosen by the Issuer.<a href="#section-7.7-17" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy_considerations">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<div id="decoy_digests_privacy">
<section id="section-8.1">
        <h3 id="name-decoy-digests-2">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-decoy-digests-2" class="section-name selfRef">Decoy Digests</a>
        </h3>
<p id="section-8.1-1">The use of decoy digests is RECOMMENDED when the number of claims (or the existence of particular claims) can be a side-channel disclosing information about otherwise undisclosed claims. In particular, if a claim in an SD-JWT is present only if a certain condition is met (e.g., a membership number is only contained if the End-User is a member of a group), the Issuer SHOULD add decoy digests when the condition is not met.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Decoy digests increase the size of the SD-JWT. The number of decoy digests (or whether to use them at all) is a trade-off between the size of the SD-JWT and the privacy of the End-User's data.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="claim-names">
<section id="section-8.2">
        <h3 id="name-claim-names">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-claim-names" class="section-name selfRef">Claim Names</a>
        </h3>
<p id="section-8.2-1">By default, claim names are not blinded in an SD-JWT. In this case, even when
the claim's value is not known to a Verifier, the claim name can disclose some
information to the Verifier. For example, if the SD-JWT contains a claim named
<code>super_secret_club_membership_no</code>, the Verifier might assume that the end-user
is a member of the Super Secret Club.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Blinding claim names can help to avoid this potential privacy issue. In many
cases, however, Verifiers can already deduce this or similar information just
from the identification of the Issuer and the schema used for the SD-JWT.
Blinding claim names might not provide additional privacy if this is the case.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Furthermore, re-using the same value to blind a claim name may limit the privacy benefits.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unlinkability">
<section id="section-8.3">
        <h3 id="name-unlinkability">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-unlinkability" class="section-name selfRef">Unlinkability</a>
        </h3>
<p id="section-8.3-1">Colluding Issuer/Verifier or Verifier/Verifier pairs could link issuance/presentation
or two presentation sessions to the same user on the basis of unique values encoded in the SD-JWT
(Issuer signature, salts, digests, etc.).<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">To prevent these types of linkability, various methods, including but not limited to the following ones can be used:<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-3.1">Use advanced cryptographic schemes, outside the scope of this specification.<a href="#section-8.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.3-3.2">Issue a batch of SD-JWTs to the Holder to enable the Holder to use a unique SD-JWT per Verifier. This only helps with Verifier/Verifier unlinkability.<a href="#section-8.3-3.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">We would like to thank
Alen Horvat,
Arjan Geluk,
Brian Campbell,
Christian Paquin,
David Bakker,
Fabian Hauck,
Giuseppe De Marco,
Kushal Das,
Mike Jones,
Nat Sakimura,
Pieter Kasselman,
Ryosuke Abe,
Shawn Butterfield, and
Torsten Lodderstedt
for their contributions (some of which substantial) to this draft and to the initial set of implementations.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The work on this draft was started at OAuth Security Workshop 2022 in Trondheim, Norway.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana_considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">TBD<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span> and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7159">[RFC7159]</dt>
      <dd>
<span class="refAuthor">Bray, T., Ed.</span> and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7159">https://www.rfc-editor.org/info/rfc7159</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span> and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="IANA.Hash.Algorithms">[IANA.Hash.Algorithms]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Named Information Hash Algorithm"</span>, <span>&lt;<a href="https://www.iana.org/assignments/named-information/named-information.xhtml">https://www.iana.org/assignments/named-information/named-information.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.JWS.Algorithms">[IANA.JWS.Algorithms]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"JSON Web Signature and Encryption Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms">https://www.iana.org/assignments/jose/jose.xhtml#web-signature-encryption-algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OIDC.IDA">[OIDC.IDA]</dt>
      <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Haine, M.</span>, <span class="refAuthor">Pulido, A.</span>, <span class="refAuthor">Lehmann, K.</span>, and <span class="refAuthor">K. Koiwai</span>, <span class="refTitle">"OpenID Connect for Identity Assurance 1.0"</span>, <span>&lt;<a href="https://openid.net/specs/openid-connect-4-identity-assurance-1_0-13.html">https://openid.net/specs/openid-connect-4-identity-assurance-1_0-13.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0020">[RFC0020]</dt>
      <dd>
<span class="refAuthor">Cerf, V.</span> and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"ASCII format for network interchange"</span>, <span class="seriesInfo">STD 80</span>, <span class="seriesInfo">RFC 20</span>, <span class="seriesInfo">DOI 10.17487/RFC0020</span>, <time datetime="1969-10" class="refDate">October 1969</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7515">[RFC7515]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7516">[RFC7516]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7800">[RFC7800]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)"</span>, <span class="seriesInfo">RFC 7800</span>, <span class="seriesInfo">DOI 10.17487/RFC7800</span>, <time datetime="2016-04" class="refDate">April 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7800">https://www.rfc-editor.org/info/rfc7800</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8725">[RFC8725]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Hardt, D.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"JSON Web Token Best Current Practices"</span>, <span class="seriesInfo">BCP 225</span>, <span class="seriesInfo">RFC 8725</span>, <span class="seriesInfo">DOI 10.17487/RFC8725</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8725">https://www.rfc-editor.org/info/rfc8725</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8785">[RFC8785]</dt>
      <dd>
<span class="refAuthor">Rundgren, A.</span>, <span class="refAuthor">Jordan, B.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">RFC Publisher</span>, <span class="refTitle">"JSON Canonicalization Scheme (JCS)"</span>, <span class="seriesInfo">RFC 8785</span>, <span class="seriesInfo">DOI 10.17487/RFC8785</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8785">https://www.rfc-editor.org/info/rfc8785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VC_DATA">[VC_DATA]</dt>
    <dd>
<span class="refAuthor">Sporny, M.</span>, <span class="refAuthor">Noble, G.</span>, <span class="refAuthor">Longley, D.</span>, <span class="refAuthor">Burnett, D. C.</span>, <span class="refAuthor">Zundel, B.</span>, and <span class="refAuthor">D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11-19" class="refDate">19 November 2019</time>, <span>&lt;<a href="https://www.w3.org/TR/vc_data">https://www.w3.org/TR/vc_data</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="additional-examples">
<section id="appendix-A">
      <h2 id="name-additional-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-additional-examples" class="section-name selfRef">Additional Examples</a>
      </h2>
<p id="appendix-A-1">All of the following examples are non-normative.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="structured-sd-jwt">
<section id="appendix-A.1">
        <h3 id="name-structured-sd-jwt">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-structured-sd-jwt" class="section-name selfRef">Structured SD-JWT</a>
        </h3>
<p id="appendix-A.1-1">The following examples show variations of a structured SD-JWT.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div id="example-simple-structured-sd-jwt">
<section id="appendix-A.1.1">
          <h4 id="name-example-2a-simple-structure">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-example-2a-simple-structure" class="section-name selfRef">Example 2a - Simple Structured SD-JWT</a>
          </h4>
<p id="appendix-A.1.1-1">This non-normative example is based on the same claim values as Example 1, but
here the Issuer decided to create a structured object for the digests. This
allows for the disclosure of individual members of the <code>address</code> claim separately.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<div id="example-simple_structured-sd_jwt_payload">
<div id="appendix-A.1.1-2">
<pre class="lang-json sourcecode">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256",
  "sd_digests": {
    "sub": "p7GDm8_lnxCJUsQojBatCJQgPCZOVBGxU-eX_lUIcC4",
    "given_name": "BrmUer7nGIRyk3sbHHcZk43M9Oy_BQar0VE3NMOGk9w",
    "family_name": "8voOnlh20GGzTInd6T9-Vcu2l6Q4_Kc-keedo7_3VY8",
    "email": "b9DpmK8_xwhR4PX_MiIsQc1TyB_1NN40lI5Kj8SSNl4",
    "phone_number": "0LFRbHdtG1eze9ET1rDEtSIrPI0poCM3J0EYBt2iwVg",
    "address": {
      "street_address":
        "qYDFWJxdl_OQDdn_lxX1-E9r5H2juwqonoWM8A76X_w",
      "locality": "3mLauig0JJyjJbdMvf3jLJGSBAIt0tdvq7F_VL1gqXw",
      "region": "qRa_XKvVxCzUK8buAsxg9ylzyQlfvUgSwqATQV74z6c",
      "country": "DjbYtjTT3PAQHtVkcpvrnRboYVUfXMro6Y4oEGdHW_0"
    },
    "birthdate": "rXv8RpBXYOy9WtYf2Bg-KIdO0a3KnYGCAhL53iCsLJA"
  }
}
</pre><a href="#appendix-A.1.1-2" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.1-3">The Disclosures Object for this SD-JWT is as follows:<a href="#appendix-A.1.1-3" class="pilcrow">¶</a></p>
<div id="example-simple_structured-iid_payload">
<div id="appendix-A.1.1-4">
<pre class="lang-json sourcecode">{
  "sd_ii_disclosures": {
    "sub": "{\"s\": \"2iFrkb5skOft_gSL6BhdBg\", \"v\":
      \"6c5c0a49-b589-431d-bae7-219122a9ec2c\"}",
    "given_name": "{\"s\": \"AbA1MKJ1Oyqtff2JoFKNXA\", \"v\":
      \"John\"}",
    "family_name": "{\"s\": \"vGk9hg40yrI1qazJn8qaKw\", \"v\":
      \"Doe\"}",
    "email": "{\"s\": \"6Ilb1QXTN4Qdv-1qGcQdbw\", \"v\":
      \"johndoe@example.com\"}",
    "phone_number": "{\"s\": \"-F5a6ZAOKHwUsYPDS383pQ\", \"v\":
      \"+1-202-555-0101\"}",
    "address": {
      "street_address": "{\"s\": \"t6GqrdbiTFbJYh4D38aLjA\", \"v\":
        \"123 Main St\"}",
      "locality": "{\"s\": \"B0G5ap7hsAPIYOJ21rUjgg\", \"v\":
        \"Anytown\"}",
      "region": "{\"s\": \"YTPF0rUHYtvldv1Df63WXQ\", \"v\":
        \"Anystate\"}",
      "country": "{\"s\": \"mVZ4hCTnVdpu_GN-Rb9wNw\", \"v\":
        \"US\"}"
    },
    "birthdate": "{\"s\": \"T6-5A3xYsyy2MnwnUWbW3w\", \"v\":
      \"1940-01-01\"}"
  }
}
</pre><a href="#appendix-A.1.1-4" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.1-5">An HS-Disclosures JWT for the SD-JWT above that discloses only <code>region</code>
and <code>country</code> of the <code>address</code> property could look as follows:<a href="#appendix-A.1.1-5" class="pilcrow">¶</a></p>
<div id="example-simple_structured-hsd_jwt_payload">
<div id="appendix-A.1.1-6">
<pre class="lang-json sourcecode">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_hs_disclosures": {
    "given_name": "{\"s\": \"AbA1MKJ1Oyqtff2JoFKNXA\", \"v\":
      \"John\"}",
    "family_name": "{\"s\": \"vGk9hg40yrI1qazJn8qaKw\", \"v\":
      \"Doe\"}",
    "birthdate": "{\"s\": \"T6-5A3xYsyy2MnwnUWbW3w\", \"v\":
      \"1940-01-01\"}",
    "address": {
      "region": "{\"s\": \"YTPF0rUHYtvldv1Df63WXQ\", \"v\":
        \"Anystate\"}",
      "country": "{\"s\": \"mVZ4hCTnVdpu_GN-Rb9wNw\", \"v\":
        \"US\"}"
    }
  }
}
</pre><a href="#appendix-A.1.1-6" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-mixed-structured-sd-jwt">
<section id="appendix-A.1.2">
          <h4 id="name-example-2b-mixing-sd-and-no">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-example-2b-mixing-sd-and-no" class="section-name selfRef">Example 2b - Mixing SD and Non-SD Claims in a Structured SD-JWT</a>
          </h4>
<p id="appendix-A.1.2-1">In this example, a variant of Example 2a, the Issuer decided to apply selective
disclosure only to some of the claims. In particular, the <code>country</code> component of
the <code>address</code> is contained in the JWT as a regular claim, whereas the rest of
the claims can be disclosed selectively. Note that the processing model
described in <a href="#processing_model" class="auto internal xref">Section 6.3</a> allows for merging the selectively disclosable
claims with the regular claims.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-2">The JSON-payload of the SD-JWT that contains both selectively
disclosable claims in the <code>sd_digests</code> object and not-selectively
disclosable claims in a top-level JWT claim would look as follows:<a href="#appendix-A.1.2-2" class="pilcrow">¶</a></p>
<div id="example-simple_structured_merging-sd_jwt_payload">
<div id="appendix-A.1.2-3">
<pre class="lang-json sourcecode">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256",
  "sd_digests": {
    "sub": "m6f849XozrOu1dDvaoGfzp_FwJ0Jpcm8LBt8BeZdxkc",
    "given_name": "CEBrXkrUZcZ3njZE46q_CEdSASdcEP0qoGrjNcPJx8g",
    "family_name": "j5ZcRWCSTbdtevKIp8L1XMunNHXZHOEDLtkJ3By4rms",
    "email": "AXm5JzGxUAfQaqTAz5hZGrhL7ZEM_J3ljKRK4wSpRvU",
    "phone_number": "Vkehj3w1-X9Ssz96tWl8lvap8EaIy9pi9q4qWzWAWNo",
    "address": {
      "street_address":
        "MVldFr-b-NKmQSLyHbnnq9ciMFGcb4GuhLtKLtmmnwk",
      "locality": "aAusTIjJS8e9QwaGs53OaHqngMZ142uDScfW41hqFm0",
      "region": "o6d8Kv-xOL3fidw5t0QF1StAlw5YLSN3Rco1aHsiWn8"
    },
    "birthdate": "_l2Sr5D08premyjfkmrnxMV6aFnEH8qMXme0BFGFGqk"
  },
  "address": {
    "country": "US"
  }
}
</pre><a href="#appendix-A.1.2-3" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.2-4">The Holder can now, for example, release the rest of the components of the <code>address</code> claim in the HS-Disclosures:<a href="#appendix-A.1.2-4" class="pilcrow">¶</a></p>
<div id="example-simple_structured_merging-hsd_jwt_payload">
<div id="appendix-A.1.2-5">
<pre class="lang-json sourcecode">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_hs_disclosures": {
    "given_name": "{\"s\": \"juf0vRMI_5aHaGZQfl5o5A\", \"v\":
      \"John\"}",
    "family_name": "{\"s\": \"mJXFsX6E6IvqR6vMd_un5A\", \"v\":
      \"Doe\"}",
    "birthdate": "{\"s\": \"vnc31gtRYVh_zW8RrqSbaw\", \"v\":
      \"1940-01-01\"}",
    "address": {
      "region": "{\"s\": \"4mt7paa9SIEuEgWIm-10kg\", \"v\":
        \"Anystate\"}",
      "street_address": "{\"s\": \"4r1Y7ivPIQzkp8rKF_BUTQ\", \"v\":
        \"123 Main St\"}",
      "locality": "{\"s\": \"v5I5nfxYin0IB2mWP1oj6Q\", \"v\":
        \"Anytown\"}"
    }
  }
}
</pre><a href="#appendix-A.1.2-5" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.2-6">The Verifier, after verifying the SD-JWT and applying the HS-Disclosures, would
process the result according to <a href="#processing_model" class="auto internal xref">Section 6.3</a> and pass the following data
to the application:<a href="#appendix-A.1.2-6" class="pilcrow">¶</a></p>
<div id="example-simple_structured_merging-merged">
<div id="appendix-A.1.2-7">
<pre class="lang-json sourcecode">{
  "given_name": "John",
  "family_name": "Doe",
  "birthdate": "1940-01-01",
  "address": {
    "region": "Anystate",
    "street_address": "123 Main St",
    "locality": "Anytown",
    "country": "US"
  },
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022
}
</pre><a href="#appendix-A.1.2-7" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-complex-structured-sd-jwt">
<section id="appendix-A.1.3">
          <h4 id="name-example-3-complex-structure">
<a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-example-3-complex-structure" class="section-name selfRef">Example 3 - Complex Structured SD-JWT</a>
          </h4>
<p id="appendix-A.1.3-1">In this example, a complex object such as those defined in OIDC4IDA
<span>[<a href="#OIDC.IDA" class="cite xref">OIDC.IDA</a>]</span> is used. Here, the Issuer is using the following user data:<a href="#appendix-A.1.3-1" class="pilcrow">¶</a></p>
<div id="example-complex-user_claims">
<div id="appendix-A.1.3-2">
<pre class="lang-json sourcecode">{
  "verified_claims": {
    "verification": {
      "trust_framework": "de_aml",
      "time": "2012-04-23T18:25Z",
      "verification_process": "f24c6f-6d3f-4ec5-973e-b0d8506f3bc7",
      "evidence": [
        {
          "type": "document",
          "method": "pipp",
          "time": "2012-04-22T11:30Z",
          "document": {
            "type": "idcard",
            "issuer": {
              "name": "Stadt Augsburg",
              "country": "DE"
            },
            "number": "53554554",
            "date_of_issuance": "2010-03-23",
            "date_of_expiry": "2020-03-22"
          }
        }
      ]
    },
    "claims": {
      "given_name": "Max",
      "family_name": "Meier",
      "nationalities": [
        "DE"
      ],
      "address": {
        "locality": "Maxstadt",
        "postal_code": "12344",
        "country": "DE",
        "street_address": "An der Weide 22"
      }
    }
  },
  "birth_middle_name": "Timotheus",
  "salutation": "Dr.",
  "msisdn": "49123456789"
}
</pre><a href="#appendix-A.1.3-2" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.3-3">The Issuer in this example further adds the two claims <code>birthdate</code> and <code>place_of_birth</code> to the <code>claims</code> element in plain text. The following shows the resulting SD-JWT payload:<a href="#appendix-A.1.3-3" class="pilcrow">¶</a></p>
<div id="example-complex-sd_jwt_payload">
<div id="appendix-A.1.3-4">
<pre class="breakable lang-json sourcecode">{
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022,
  "sd_digest_derivation_alg": "sha-256",
  "sd_digests": {
    "verified_claims": {
      "verification": {
        "trust_framework":
          "fkIW-4iUZgTeIeDg_Z_6oFHU-wyWwazSpuaiQbc5QKw",
        "time": "VRF-G_LfTzSaYkLelVzry82l1zQxGwk1RfGcnUUWukc",
        "verification_process":
          "9OpDml4eRBM6Usfk3MF2i7kBl1xGGkzPq5Ncs1mvbPo",
        "evidence": [
          {
            "type": "HucanHhQwb-TJNg_rVpaonNSDtzPrCEebb3LfXTuLSM",
            "method": "aU7IO7ooT8vArMkqpOfkIAlKw8BNcfRyw3NXs3ZS128",
            "time": "LHcH98bV3-ZNUa00HNnqOf8W5IdijY1aEnpVzDNVBwA",
            "document": {
              "type": "3ITIlfkbUI0NveviEJBw-_VEaGiPtCDcXy9uD9orWFA",
              "issuer": {
                "name":
                  "AY7wW63Vbcd7RnKDb39sSXpLgyiVNxWgoRnV6xZD5C8",
                "country":
                  "Kd3aUmm6XHjpWp6OYiJeEZUrD5J7nIRU3SlTc-E53gs"
              },
              "number":
                "8gKpksl66fN9F2Zxs1PRPgD8kHi8dGC2JzpqtrPZavs",
              "date_of_issuance":
                "GfIEhOGWwe8J7lx6HSAPpC-Qvx0ihwWkEE0_LZ-r_DI",
              "date_of_expiry":
                "_fdljKRdp5wptGi7DwKNZEsSX6AnniVqmDE0aSznH74"
            }
          }
        ]
      },
      "claims": {
        "given_name": "sx4wGd6-ONAsiq7dN16GHeg4RAyOshRBdoXWE_E751w",
        "family_name":
          "Ldbea0SibAQDiZJlBigptwWXZ9QA8a0dKK7jipSn2K8",
        "nationalities":
          "tr8SXHdYS0rzAio_IhFp2lzlta4kDzKCM7hUxItCU2U",
        "address": {
          "locality": "VFgKHPXnNrZHeoBwcu61b5VCoFVX0rQjtH5aOiiLz0E",
          "postal_code":
            "G8XHi8sCPc45WATery6RSvnEcdypnrjypjBl4LBd5YE",
          "country": "YyG4Nhyfjitpo6-yMDRTARSVAnZNvkYqRY3XepoQ_j8",
          "street_address":
            "NwAKfAtjQcN_XbV3kuHt3gbUMvQ83n02C1EexI9Ro2A"
        }
      }
    },
    "birth_middle_name":
      "M5GhkvNcGjGONRey2pRORuL2yCfYz5jo0XqF6K0tUWk",
    "salutation": "8m0-sBNA8I88_LDc05C7gE31pTm_CXQfewiwlL1Sn1Y",
    "msisdn": "dLQVMDIkEHnmPVvuHNYiv7WwAqGE7mbyJMh5EfbjM1Q"
  },
  "verified_claims": {
    "claims": {
      "birthdate": "1956-01-28",
      "place_of_birth": {
        "country": "DE",
        "locality": "Musterstadt"
      }
    }
  }
}
</pre><a href="#appendix-A.1.3-4" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.3-5">The SD-JWT is then signed by the Issuer to create a document like the following:<a href="#appendix-A.1.3-5" class="pilcrow">¶</a></p>
<div id="example-complex-serialized_sd_jwt">
<div class="alignLeft art-text artwork" id="appendix-A.1.3-6">
<pre>eyJhbGciOiAiUlMyNTYiLCAia2lkIjogImNBRUlVcUowY21MekQxa3pHemhlaUJhZzBZ
UkF6VmRsZnhOMjgwTmdIYUEifQ.eyJpc3MiOiAiaHR0cHM6Ly9leGFtcGxlLmNvbS9pc
3N1ZXIiLCAiY25mIjogeyJqd2siOiB7Imt0eSI6ICJSU0EiLCAibiI6ICJwbTRiT0hCZ
y1vWWhBeVBXelI1NkFXWDNyVUlYcDExX0lDRGtHZ1M2VzNaV0x0cy1oendJM3g2NTY1O
WtnNGhWbzlkYkdvQ0pFM1pHRl9lYWV0RTMwVWhCVUVncEd3ckRyUWlKOXpxcHJtY0Zmc
jNxdnZrR2p0dGg4WmdsMWVNMmJKY093RTdQQ0JIV1RLV1lzMTUyUjdnNkpnMk9WcGgtY
ThycS1xNzlNaEtHNVFvV19tVHoxMFFUXzZINGM3UGpXRzFmamg4aHBXTm5iUF9wdjZkM
XpTd1pmYzVmbDZ5VlJMMERWMFYzbEdIS2UyV3FmX2VOR2pCckJMVmtsRFRrOC1zdFhfT
VdMY1ItRUdtWEFPdjBVQldpdFNfZFhKS0p1LXZYSnl3MTRuSFNHdXhUSUsyaHgxcHR0T
WZ0OUNzdnFpbVhLZURUVTE0cVFMMWVFN2loY3ciLCAiZSI6ICJBUUFCIn19LCAiaWF0I
jogMTUxNjIzOTAyMiwgImV4cCI6IDE1MTYyNDcwMjIsICJzZF9kaWdlc3RfZGVyaXZhd
Glvbl9hbGciOiAic2hhLTI1NiIsICJzZF9kaWdlc3RzIjogeyJ2ZXJpZmllZF9jbGFpb
XMiOiB7InZlcmlmaWNhdGlvbiI6IHsidHJ1c3RfZnJhbWV3b3JrIjogImZrSVctNGlVW
mdUZUllRGdfWl82b0ZIVS13eVd3YXpTcHVhaVFiYzVRS3ciLCAidGltZSI6ICJWUkYtR
19MZlR6U2FZa0xlbFZ6cnk4MmwxelF4R3drMVJmR2NuVVVXdWtjIiwgInZlcmlmaWNhd
Glvbl9wcm9jZXNzIjogIjlPcERtbDRlUkJNNlVzZmszTUYyaTdrQmwxeEdHa3pQcTVOY
3MxbXZiUG8iLCAiZXZpZGVuY2UiOiBbeyJ0eXBlIjogIkh1Y2FuSGhRd2ItVEpOZ19yV
nBhb25OU0R0elByQ0VlYmIzTGZYVHVMU00iLCAibWV0aG9kIjogImFVN0lPN29vVDh2Q
XJNa3FwT2ZrSUFsS3c4Qk5jZlJ5dzNOWHMzWlMxMjgiLCAidGltZSI6ICJMSGNIOThiV
jMtWk5VYTAwSE5ucU9mOFc1SWRpalkxYUVucFZ6RE5WQndBIiwgImRvY3VtZW50Ijoge
yJ0eXBlIjogIjNJVElsZmtiVUkwTnZldmlFSkJ3LV9WRWFHaVB0Q0RjWHk5dUQ5b3JXR
kEiLCAiaXNzdWVyIjogeyJuYW1lIjogIkFZN3dXNjNWYmNkN1JuS0RiMzlzU1hwTGd5a
VZOeFdnb1JuVjZ4WkQ1QzgiLCAiY291bnRyeSI6ICJLZDNhVW1tNlhIanBXcDZPWWlKZ
UVaVXJENUo3bklSVTNTbFRjLUU1M2dzIn0sICJudW1iZXIiOiAiOGdLcGtzbDY2Zk45R
jJaeHMxUFJQZ0Q4a0hpOGRHQzJKenBxdHJQWmF2cyIsICJkYXRlX29mX2lzc3VhbmNlI
jogIkdmSUVoT0dXd2U4SjdseDZIU0FQcEMtUXZ4MGlod1drRUUwX0xaLXJfREkiLCAiZ
GF0ZV9vZl9leHBpcnkiOiAiX2ZkbGpLUmRwNXdwdEdpN0R3S05aRXNTWDZBbm5pVnFtR
EUwYVN6bkg3NCJ9fV19LCAiY2xhaW1zIjogeyJnaXZlbl9uYW1lIjogInN4NHdHZDYtT
05Bc2lxN2ROMTZHSGVnNFJBeU9zaFJCZG9YV0VfRTc1MXciLCAiZmFtaWx5X25hbWUiO
iAiTGRiZWEwU2liQVFEaVpKbEJpZ3B0d1dYWjlRQThhMGRLSzdqaXBTbjJLOCIsICJuY
XRpb25hbGl0aWVzIjogInRyOFNYSGRZUzByekFpb19JaEZwMmx6bHRhNGtEektDTTdoV
XhJdENVMlUiLCAiYWRkcmVzcyI6IHsibG9jYWxpdHkiOiAiVkZnS0hQWG5OclpIZW9Cd
2N1NjFiNVZDb0ZWWDByUWp0SDVhT2lpTHowRSIsICJwb3N0YWxfY29kZSI6ICJHOFhIa
ThzQ1BjNDVXQVRlcnk2UlN2bkVjZHlwbnJqeXBqQmw0TEJkNVlFIiwgImNvdW50cnkiO
iAiWXlHNE5oeWZqaXRwbzYteU1EUlRBUlNWQW5aTnZrWXFSWTNYZXBvUV9qOCIsICJzd
HJlZXRfYWRkcmVzcyI6ICJOd0FLZkF0alFjTl9YYlYza3VIdDNnYlVNdlE4M24wMkMxR
WV4STlSbzJBIn19fSwgImJpcnRoX21pZGRsZV9uYW1lIjogIk01R2hrdk5jR2pHT05SZ
XkycFJPUnVMMnlDZll6NWpvMFhxRjZLMHRVV2siLCAic2FsdXRhdGlvbiI6ICI4bTAtc
0JOQThJODhfTERjMDVDN2dFMzFwVG1fQ1hRZmV3aXdsTDFTbjFZIiwgIm1zaXNkbiI6I
CJkTFFWTURJa0VIbm1QVnZ1SE5ZaXY3V3dBcUdFN21ieUpNaDVFZmJqTTFRIn0sICJ2Z
XJpZmllZF9jbGFpbXMiOiB7ImNsYWltcyI6IHsiYmlydGhkYXRlIjogIjE5NTYtMDEtM
jgiLCAicGxhY2Vfb2ZfYmlydGgiOiB7ImNvdW50cnkiOiAiREUiLCAibG9jYWxpdHkiO
iAiTXVzdGVyc3RhZHQifX19fQ.57pncJcJ6cQt2fSARbQLlj6e6nYMpWqHNvI2Ep45Wm
NGuTtI3htmodK8svpgbrT-RaLL25WF7J3CqP1ElzpZSgVFs2VXCxGXgnTG6dQIvk2qPP
fP-45hrZiMWyiwRFBr7Di68J01N90yFGbsMH5hh8kGGqFnCpTSQwvk--6aG_03l0nGmL
DjOFyauCF_Tl-SlOHzNGYoP3MOOX9jU25T8z2e3EmLVLTa5KEmNis0GbpfSHUthbtZCC
Taq-bSYaPDUHi22ZNqeoW1Y4v8nSaNIyrV9IxfPJNb37kYN6NLn5zwI33sxE_nCd8wOx
vuI0rtFtmpS_-DNgwPTnLphzUNKA
</pre><a href="#appendix-A.1.3-6" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.3-7">An HS-Disclosures JWT for some of the claims may look as follows:<a href="#appendix-A.1.3-7" class="pilcrow">¶</a></p>
<div id="example-complex-hsd_jwt_payload">
<div id="appendix-A.1.3-8">
<pre class="lang-json sourcecode">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_hs_disclosures": {
    "verified_claims": {
      "verification": {
        "trust_framework": "{\"s\": \"SJKr-Pydh8RqHomXCOiVwQ\",
          \"v\": \"de_aml\"}",
        "time": "{\"s\": \"CrxH2Ez8uu2t7tEPQqwZig\", \"v\":
          \"2012-04-23T18:25Z\"}",
        "evidence": [
          {
            "type": "{\"s\": \"sPCCbZtOdjnQjfOiPBxOYA\", \"v\":
              \"document\"}"
          }
        ]
      },
      "claims": {
        "given_name": "{\"s\": \"kqwnbB6oHhaBD3F3t-KUGw\", \"v\":
          \"Max\"}",
        "family_name": "{\"s\": \"_6Do5glcgEQDMVJoPArGSA\", \"v\":
          \"Meier\"}"
      }
    }
  }
}
</pre><a href="#appendix-A.1.3-8" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.1.3-9">After verifying the SD-JWT and HS-Disclosures, the Verifier merges the selectively
disclosed claims into the other data contained in the JWT. The Verifier will
then pass the result on to the application for further processing:<a href="#appendix-A.1.3-9" class="pilcrow">¶</a></p>
<div id="example-complex-merged">
<div id="appendix-A.1.3-10">
<pre class="lang-json sourcecode">{
  "verified_claims": {
    "verification": {
      "trust_framework": "de_aml",
      "time": "2012-04-23T18:25Z",
      "evidence": [
        {
          "type": "document"
        }
      ]
    },
    "claims": {
      "given_name": "Max",
      "family_name": "Meier",
      "birthdate": "1956-01-28",
      "place_of_birth": {
        "country": "DE",
        "locality": "Musterstadt"
      }
    }
  },
  "iss": "https://example.com/issuer",
  "cnf": {
    "jwk": {
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw",
      "e": "AQAB"
    }
  },
  "iat": 1516239022,
  "exp": 1516247022
}
</pre><a href="#appendix-A.1.3-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
<div id="example-4-w3c-verifiable-credentials-data-model-work-in-progress">
<section id="appendix-A.2">
        <h3 id="name-example-4-w3c-verifiable-cr">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-example-4-w3c-verifiable-cr" class="section-name selfRef">Example 4 - W3C Verifiable Credentials Data Model (work in progress)</a>
        </h3>
<p id="appendix-A.2-1">This example illustrates how the artifacts defined in this specification can be
represented using W3C Verifiable Credentials Data Model as defined in
<span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">SD-JWT is equivalent to an Issuer-signed W3C Verifiable Credential (W3C VC). Disclosures Object is sent alongside a VC.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">HS-Disclosures JWT is equivalent to a Holder-signed W3C Verifiable Presentation (W3C VP).<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">Holder Binding is applied and HS-Disclosures JWT is signed using a raw public key passed in a <code>cnf</code> Claim in a W3C VC (SD-JWT).<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2-5">HS-Disclosures JWT as a W3C VP contains a <code>verifiableCredential</code> claim inside a <code>vp</code> claim that is a string array of an SD-JWT as a W3C VC using JWT compact serialization.<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<p id="appendix-A.2-6">Below is a non-normative example of an SD-JWT represented as a verifiable credential
encoded as JSON and signed as JWS compliant to <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>.<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<p id="appendix-A.2-7">Disclosures Object is the same as in Example 1.<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<div id="appendix-A.2-8">
<pre class="lang-json sourcecode">{
  "sub": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCc
    d-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
  "jti": "http://example.edu/credentials/3732",
  "iss": "https://example.com/keys/foo.jwk",
  "nbf": 1541493724,
  "iat": 1541493724,
  "exp": 1573029723,
  "cnf": {
    "jwk": {
      "kty":"RSA",
      "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx
     4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs
     tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2
     QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI
     SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb
     w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
      "e":"AQAB"
    }
  },
  "vc": {
    "@context": [
      "https://www.w3.org/2018/credentials/v1"
    ],
    "type": [
      "VerifiableCredential",
      "UniversityDegreeCredential"
    ],
    "credentialSubject": {
      "first_name": "Jane",
      "last_name": "Doe"
    }
  },
  "sd_digests": {
    "vc": {
      "credentialSubject": {
        "email": "-Rcr4fDyjwlM_itcMxoQZCE1QAEwyLJcibEpH114KiE",
        "phone_number": "Jv2nw0C1wP5ASutYNAxrWEnaDRIpiF0eTUAkUOp8F6Y",
        "address": "ZrjKs-RmEAVeAYSzSw6GPFrMpcgctCfaJ6t9qQhbfJ4",
        "birthdate": "qXPRRPdpNaebP8jtbEpO-skF4n7v7ASTh8oLg0mkAdQ"
      }
    }
  }
}
</pre><a href="#appendix-A.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-9">Below is a non-normative example of a HS-Disclosures JWT represented as a verifiable presentation
encoded as JSON and signed as a JWS compliant to <span>[<a href="#VC_DATA" class="cite xref">VC_DATA</a>]</span>.<a href="#appendix-A.2-9" class="pilcrow">¶</a></p>
<div id="appendix-A.2-10">
<pre class="lang-json sourcecode">{
  "alg": "RS256",
  "typ": "JWT",
  "jwk": {
      "kty":"RSA",
      "n": "0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx
     4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs
     tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2
     QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI
     SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb
     w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw",
      "e":"AQAB"
    }
}.{
  "iss": "urn:ietf:params:oauth:jwk-thumbprint:sha-256:NzbLsXh8uDCc
    d-6MNwXF4W_7noWXFZAfHkxZsRGC9Xs",
  "aud": "s6BhdRkqt3",
  "nbf": 1560415047,
  "iat": 1560415047,
  "exp": 1573029723,
  "nonce": "660!6345FSer",
  "vp": {
    "@context": [
      "https://www.w3.org/2018/credentials/v1"
    ],
    "type": [
      "VerifiablePresentation"
    ],
    "verifiableCredential": ["eyJhb...npyXw"]
  },
  "sd_hs_disclosures": {
    "vc": {
      "credentialSubject": {
        "email": "{\"s\": \"Pc33JM2LchcU_lHggv_ufQ\", \"v\":
          \"johndoe@example.com\"}",
        "phone_number": "{\"s\": \"lklxF5jMYlGTPUovMNIvCA\", \"v\":
          \"+1-202-555-0101\"}",
        "address": "{\"s\": \"5bPs1IquZNa0hkaFzzzZNw\", \"v\":
          {\"street_address\": \"123 Main St\", \"locality\":
          \"Anytown\", \"region\": \"Anystate\", \"country\":
          \"US\"}}",
        "birthdate": "{\"s\": \"y1sVU5wdfJahVdgwPgS7RQ\", \"v\":
          \"1940-01-01\"}"
      }
    }

  }
}
</pre><a href="#appendix-A.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="blinding-claim-names-1">
<section id="appendix-A.3">
        <h3 id="name-blinding-claim-names-2">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-blinding-claim-names-2" class="section-name selfRef">Blinding Claim Names</a>
        </h3>
<p id="appendix-A.3-1">The following examples show the use of blinded claim names.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div id="example-5-some-blinded-claims">
<section id="appendix-A.3.1">
          <h4 id="name-example-5-some-blinded-clai">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-example-5-some-blinded-clai" class="section-name selfRef">Example 5: Some Blinded Claims</a>
          </h4>
<p id="appendix-A.3.1-1">The following shows the user information used in this example, included a claim named <code>secret_club_membership_no</code>:<a href="#appendix-A.3.1-1" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-user_claims">
<div id="appendix-A.3.1-2">
<pre class="lang-json sourcecode">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "given_name": "John",
  "family_name": "Doe",
  "email": "johndoe@example.com",
  "phone_number": "+1-202-555-0101",
  "secret_club_membership_no": "23",
  "other_secret_club_membership_no": "42",
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "birthdate": "1940-01-01"
}
</pre><a href="#appendix-A.3.1-2" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.1-3">Hiding just the claim <code>secret_club_membership_no</code>, the SD-JWT payload shown in the following would
result. Note that the claims are sorted (here by unicode code point
numbers) as described in <a href="#blinding-claim-names" class="auto internal xref">Section 7.7</a>.<a href="#appendix-A.3.1-3" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-sd_jwt_payload">
<div id="appendix-A.3.1-4">
<pre class="lang-json sourcecode">{
  "cnf": {
    "jwk": {
      "e": "AQAB",
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw"
    }
  },
  "exp": 1516247022,
  "iat": 1516239022,
  "iss": "https://example.com/issuer",
  "sd_digest_derivation_alg": "sha-256",
  "sd_digests": {
    "HS4QoeE9ty-I8BZTEupSzw":
      "emp2qhunGPulOGvtgor5dFwNSasDewLqNdqXCkYl4Nw",
    "address": {
      "country": "Bktf3gG1tXbn0XObrZT53RUr_lxMLZGEguLYwCvsaIg",
      "locality": "NeWRh4B9JLRfEODwno3UOXg9Pg3gtZEo45cK9pr4eZk",
      "region": "qpgFbdX1Az4Hm_E63K3J94oMzazHLCqqFb0Damo2eFE",
      "street_address":
        "6Ex8b2gEeACuMal74_OBH_ROVNM7wvzjSck08EC9eSs"
    },
    "birthdate": "1IjWWzdrXEs7iXUbsahdx_-8CIJsz2bcHHH_ccwgTBg",
    "email": "gszmttjNfSw7_uL31KyJRvWgL1gHM6O3LFAzqxluWDQ",
    "family_name": "Xbz5qK4Fqg-bS_CdwQYd_7qiNS9W810mRn42-FTHMPo",
    "given_name": "asBCBSyK-B45q79qxGMe6j4MijK4lZsHHCD8O_jsDdc",
    "other_secret_club_membership_no":
      "3RP5qguZWamNuvdrFS-sqqYq_MaCIzx6Zn_bOZyE9BY",
    "phone_number": "lB98F2RApo-ifhA3lwJGdqV-PAURkstN-oHmCv4LmxA",
    "sub": "sJ88WF6Q05a2eyPnLJHXzZ8bbiQXWlXl44Nss7Ywk0E"
  }
}
</pre><a href="#appendix-A.3.1-4" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.1-5">In the Disclosures Object, it can be seen that the blinded claim's original name is <code>secret_club_membership_no</code>. Note that the claims are sorted alphabetically as described in <a href="#blinding-claim-names" class="auto internal xref">Section 7.7</a>.<a href="#appendix-A.3.1-5" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-iid_payload">
<div id="appendix-A.3.1-6">
<pre class="lang-json sourcecode">{
  "sd_ii_disclosures": {
    "HS4QoeE9ty-I8BZTEupSzw": "{\"s\": \"iq6rolXF0SyWSsdCeaETNg\",
      \"v\": \"23\", \"n\": \"secret_club_membership_no\"}",
    "address": {
      "country": "{\"s\": \"l-6DlGlNloOsAUlBhMOt_Q\", \"v\":
        \"US\"}",
      "locality": "{\"s\": \"c6kc69Gmh04VVNPRlhOV_g\", \"v\":
        \"Anytown\"}",
      "region": "{\"s\": \"qwybxKQUee9A0mMhzGC-Pg\", \"v\":
        \"Anystate\"}",
      "street_address": "{\"s\": \"qNsw9K05ZngcEqXLEGalHA\", \"v\":
        \"123 Main St\"}"
    },
    "birthdate": "{\"s\": \"OErzfd2Gy6jw1atlcCpr6A\", \"v\":
      \"1940-01-01\"}",
    "email": "{\"s\": \"woZIMokulfwyF_do1czRaA\", \"v\":
      \"johndoe@example.com\"}",
    "family_name": "{\"s\": \"ZXPEdf3K8mtRBKDAMjEcBQ\", \"v\":
      \"Doe\"}",
    "given_name": "{\"s\": \"btsLJCwSb0B7gtVLPMjjqA\", \"v\":
      \"John\"}",
    "other_secret_club_membership_no": "{\"s\":
      \"Fj8RxKoVno-9SOVOEUoMpw\", \"v\": \"42\"}",
    "phone_number": "{\"s\": \"YJSPlYo_aenthOCkapFRTg\", \"v\":
      \"+1-202-555-0101\"}",
    "sub": "{\"s\": \"Rj94TRxr3nvOw2WKtujLSA\", \"v\":
      \"6c5c0a49-b589-431d-bae7-219122a9ec2c\"}"
  }
}
</pre><a href="#appendix-A.3.1-6" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.1-7">The Verifier would learn this information via the HS-Disclosures JWT:<a href="#appendix-A.3.1-7" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-hsd_jwt_payload">
<div id="appendix-A.3.1-8">
<pre class="lang-json sourcecode">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_hs_disclosures": {
    "given_name": "{\"s\": \"btsLJCwSb0B7gtVLPMjjqA\", \"v\":
      \"John\"}",
    "family_name": "{\"s\": \"ZXPEdf3K8mtRBKDAMjEcBQ\", \"v\":
      \"Doe\"}",
    "birthdate": "{\"s\": \"OErzfd2Gy6jw1atlcCpr6A\", \"v\":
      \"1940-01-01\"}",
    "address": {
      "region": "{\"s\": \"qwybxKQUee9A0mMhzGC-Pg\", \"v\":
        \"Anystate\"}",
      "country": "{\"s\": \"l-6DlGlNloOsAUlBhMOt_Q\", \"v\":
        \"US\"}"
    },
    "HS4QoeE9ty-I8BZTEupSzw": "{\"s\": \"iq6rolXF0SyWSsdCeaETNg\",
      \"v\": \"23\", \"n\": \"secret_club_membership_no\"}"
  }
}
</pre><a href="#appendix-A.3.1-8" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.1-9">The Verifier would decode the data as follows:<a href="#appendix-A.3.1-9" class="pilcrow">¶</a></p>
<div id="example-simple_structured_some_blinded-verified_contents">
<div id="appendix-A.3.1-10">
<pre class="lang-json sourcecode">{
  "given_name": "John",
  "family_name": "Doe",
  "birthdate": "1940-01-01",
  "address": {
    "region": "Anystate",
    "country": "US"
  },
  "secret_club_membership_no": "23"
}
</pre><a href="#appendix-A.3.1-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="example-6-all-claim-names-blinded">
<section id="appendix-A.3.2">
          <h4 id="name-example-6-all-claim-names-b">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-example-6-all-claim-names-b" class="section-name selfRef">Example 6: All Claim Names Blinded</a>
          </h4>
<p id="appendix-A.3.2-1">In this example, all claim names are blinded. The user data includes a
non-standard <code>delivery_address</code> claim to show that even though the same
claim name appears at different places within the structure, different
salts and blinded claim names are used for them:<a href="#appendix-A.3.2-1" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-user_claims">
<div id="appendix-A.3.2-2">
<pre class="lang-json sourcecode">{
  "sub": "6c5c0a49-b589-431d-bae7-219122a9ec2c",
  "given_name": "John",
  "family_name": "Doe",
  "email": "johndoe@example.com",
  "phone_number": "+1-202-555-0101",
  "secret_club_membership_no": "23",
  "address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "delivery_address": {
    "street_address": "123 Main St",
    "locality": "Anytown",
    "region": "Anystate",
    "country": "US"
  },
  "birthdate": "1940-01-01"
}
</pre><a href="#appendix-A.3.2-2" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.2-3">The resulting SD-JWT payload:<a href="#appendix-A.3.2-3" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-sd_jwt_payload">
<div id="appendix-A.3.2-4">
<pre class="breakable lang-json sourcecode">{
  "cnf": {
    "jwk": {
      "e": "AQAB",
      "kty": "RSA",
      "n": "pm4bOHBg-oYhAyPWzR56AWX3rUIXp11_ICDkGgS6W3ZWLts-hzwI3x65
        659kg4hVo9dbGoCJE3ZGF_eaetE30UhBUEgpGwrDrQiJ9zqprmcFfr3qvvkG
        jtth8Zgl1eM2bJcOwE7PCBHWTKWYs152R7g6Jg2OVph-a8rq-q79MhKG5QoW
        _mTz10QT_6H4c7PjWG1fjh8hpWNnbP_pv6d1zSwZfc5fl6yVRL0DV0V3lGHK
        e2Wqf_eNGjBrBLVklDTk8-stX_MWLcR-EGmXAOv0UBWitS_dXJKJu-vXJyw1
        4nHSGuxTIK2hx1pttMft9CsvqimXKeDTU14qQL1eE7ihcw"
    }
  },
  "exp": 1516247022,
  "iat": 1516239022,
  "iss": "https://example.com/issuer",
  "sd_digest_derivation_alg": "sha-256",
  "sd_digests": {
    "2lrQaXAeV85isgBjuHAOfw":
      "2kT2ohIPzxb8Mt2aa8YJ7Rj_SmTUrSIfzCz8zVXix5E",
    "HTQvLIU4zz7NkMr5p4KDWw":
      "4Hyw9wnR-uEvbJPSyQdrZMz6JY99mLqR_9m_lntD4_s",
    "HmNQxl6SFAx_Su6uDR94lg":
      "tmuay_zrl23ZdDX1hIyI48a4huCiTf70chBEvAl2Qf0",
    "_ZzazarE9UrZHTv3BnHJ1w":
      "uW7QffEkT_Hw4q_LrsIDV5vcQGh7ubQdKSOJc5qXRiQ",
    "address": {
      "MXDpEmt5sRxRxlDw8YAdfA":
        "9Lu5UyimpvSrpJU9R80aEpzemufK8eRH5QEKo5xLJj0",
      "SdQneYafbrvTMuPyyQhj2A":
        "f54HJqBhU7gC1MHPaMYzzlr9vg96qE3eo4kP2zXoKTc",
      "abIR4EGTTgQKNXnmxoY5qA":
        "QDUyK4ACX0mVPfCm7uVQFwbBPNo6_xI6-3fHZaHEQW0",
      "zno2BBCk2a7pk49dcZYnqw":
        "Ho4wYzUNdQow3TBdPmH5Fbq-4Me_fx8pECok3NJMfFM"
    },
    "aqdLloEIUy4FVDdmmSo48w":
      "C5XJjFnU9CX-k_xIo7qxX_CsLKcR5GDqJJ3MBy_o1Zg",
    "cIsqMhsylJDPtEpoqVGLvQ":
      "wWR4GNiwmcPPbTfuIwphr3j4Vs95TCjUzytdiPC7434",
    "delivery_address": {
      "Q7vBvGQFVCw8keOQLY1SVg":
        "sPeIeivTQeApuZ2piXouWMEm1xA_liTae8BsEOQ7z9M",
      "bMMGdJM0qO_zqVo75zun1w":
        "xTM2Ojec5bxvHY6sOt5c47LeMErCR7TSc1tJ51v28tQ",
      "bxNsq8p-Jobl47JNkhNOMA":
        "AF3X_wkKrY4KHiajZ5vhv7CzUp-ATXe-Jtl5x7QUAcg",
      "kR7kfLZF-3YiQ5VRgsY3yA":
        "crbT6qlk8nmEkwqO_GsFUUQHNq7DxoU0ziMh22Cxe7M"
    },
    "vEA0i5_1JvuDfS7hH7TWZw":
      "d9Wa_qCEbikmrXt_1refkreitUPIbZWNn5miQGZWPKg"
  }
}
</pre><a href="#appendix-A.3.2-4" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.2-5">The Disclosures Object:
{#example-simple<em>structured</em>all<em>blinded-iid</em>payload}<a href="#appendix-A.3.2-5" class="pilcrow">¶</a></p>
<div id="appendix-A.3.2-6">
<pre class="lang-json sourcecode">{
  "sd_ii_disclosures": {
    "2lrQaXAeV85isgBjuHAOfw": "{\"s\": \"PdxYWdt_MFsC6qce2uiVLQ\",
      \"v\": \"+1-202-555-0101\", \"n\": \"phone_number\"}",
    "HTQvLIU4zz7NkMr5p4KDWw": "{\"s\": \"353CLP3ZZFmxJQ6aZ_HDYg\",
      \"v\": \"John\", \"n\": \"given_name\"}",
    "HmNQxl6SFAx_Su6uDR94lg": "{\"s\": \"Qb5pmhvwzr4aRd7g7QVckA\",
      \"v\": \"23\", \"n\": \"secret_club_membership_no\"}",
    "_ZzazarE9UrZHTv3BnHJ1w": "{\"s\": \"yL66N684FNAao5hWfBqc6A\",
      \"v\": \"1940-01-01\", \"n\": \"birthdate\"}",
    "address": {
      "MXDpEmt5sRxRxlDw8YAdfA": "{\"s\": \"3VzdS1O4wRgglXFk_ENJ2g\",
        \"v\": \"Anytown\", \"n\": \"locality\"}",
      "SdQneYafbrvTMuPyyQhj2A": "{\"s\": \"VQz3c8LhaQCy7hqEsusPPA\",
        \"v\": \"US\", \"n\": \"country\"}",
      "abIR4EGTTgQKNXnmxoY5qA": "{\"s\": \"BhX1rStOsN3_vk_Kx4IgOg\",
        \"v\": \"Anystate\", \"n\": \"region\"}",
      "zno2BBCk2a7pk49dcZYnqw": "{\"s\": \"u2jvKsy0g-inkL3RAcpssw\",
        \"v\": \"123 Main St\", \"n\": \"street_address\"}"
    },
    "aqdLloEIUy4FVDdmmSo48w": "{\"s\": \"Y3d_N7vZNfNp7KWDmCpJlA\",
      \"v\": \"Doe\", \"n\": \"family_name\"}",
    "cIsqMhsylJDPtEpoqVGLvQ": "{\"s\": \"bbdW6Rtr4YEaDvydH4Yerw\",
      \"v\": \"johndoe@example.com\", \"n\": \"email\"}",
    "delivery_address": {
      "Q7vBvGQFVCw8keOQLY1SVg": "{\"s\": \"nBOOpTNOcCScA_MHr9P9SQ\",
        \"v\": \"Anystate\", \"n\": \"region\"}",
      "bMMGdJM0qO_zqVo75zun1w": "{\"s\": \"urI5m4JPtDbe9rRQbXgtEg\",
        \"v\": \"US\", \"n\": \"country\"}",
      "bxNsq8p-Jobl47JNkhNOMA": "{\"s\": \"LojbKO3mpEE6WTgSL5EzMg\",
        \"v\": \"123 Main St\", \"n\": \"street_address\"}",
      "kR7kfLZF-3YiQ5VRgsY3yA": "{\"s\": \"e925I1ajysz2xx9kzyzveg\",
        \"v\": \"Anytown\", \"n\": \"locality\"}"
    },
    "vEA0i5_1JvuDfS7hH7TWZw": "{\"s\": \"i_rQHJJUvGFdOgVVM8H8Ww\",
      \"v\": \"6c5c0a49-b589-431d-bae7-219122a9ec2c\", \"n\":
      \"sub\"}"
  }
}
</pre><a href="#appendix-A.3.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.2-7">Here, the Holder decided only to disclose a subset of the claims to the Verifier:<a href="#appendix-A.3.2-7" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-hsd_jwt_payload">
<div id="appendix-A.3.2-8">
<pre class="lang-json sourcecode">{
  "nonce": "XZOUco1u_gEPknxS78sWWg",
  "aud": "https://example.com/verifier",
  "sd_hs_disclosures": {
    "HTQvLIU4zz7NkMr5p4KDWw": "{\"s\": \"353CLP3ZZFmxJQ6aZ_HDYg\",
      \"v\": \"John\", \"n\": \"given_name\"}",
    "aqdLloEIUy4FVDdmmSo48w": "{\"s\": \"Y3d_N7vZNfNp7KWDmCpJlA\",
      \"v\": \"Doe\", \"n\": \"family_name\"}",
    "_ZzazarE9UrZHTv3BnHJ1w": "{\"s\": \"yL66N684FNAao5hWfBqc6A\",
      \"v\": \"1940-01-01\", \"n\": \"birthdate\"}",
    "address": {
      "abIR4EGTTgQKNXnmxoY5qA": "{\"s\": \"BhX1rStOsN3_vk_Kx4IgOg\",
        \"v\": \"Anystate\", \"n\": \"region\"}",
      "SdQneYafbrvTMuPyyQhj2A": "{\"s\": \"VQz3c8LhaQCy7hqEsusPPA\",
        \"v\": \"US\", \"n\": \"country\"}"
    }
  }
}
</pre><a href="#appendix-A.3.2-8" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-A.3.2-9">The Verifier would decode the HS-Disclosures JWT and SD-JWT as follows:<a href="#appendix-A.3.2-9" class="pilcrow">¶</a></p>
<div id="example-simple_structured_all_blinded-verified_contents">
<div id="appendix-A.3.2-10">
<pre class="lang-json sourcecode">{
  "given_name": "John",
  "family_name": "Doe",
  "birthdate": "1940-01-01",
  "address": {
    "region": "Anystate",
    "country": "US"
  }
}
</pre><a href="#appendix-A.3.2-10" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="document-history">
<section id="appendix-B">
      <h2 id="name-document-history">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-B-1">[[ To be removed from the final specification ]]<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">-03<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-3.1">Disclosures are now delivered not as a JWT but as separate base64url-encoded JSON objects.<a href="#appendix-B-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-3.2">In the SD-JWT, hash digests are collected under a <code>_sd</code> claim per level.<a href="#appendix-B-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-3.3">Terms "II-Disclosures" and "HS-Disclosures" are replaces with "Disclosures".<a href="#appendix-B-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-3.4">Holder Binding is now separate from delivering the Disclosures and implemented, if required, with a separate JWT.<a href="#appendix-B-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-3.5">Examples are now pulled in from the examples directory, not inlined.<a href="#appendix-B-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-4">-02<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-5.1">reformatted<a href="#appendix-B-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-6">-01<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-7.1">introduced blinded claim names<a href="#appendix-B-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.2">explained why JSON-encoding of values is needed<a href="#appendix-B-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.3">explained merging algorithm ("processing model")<a href="#appendix-B-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.4">generalized hash alg to digest derivation alg which also enables HMAC to calculate digests<a href="#appendix-B-7.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.5">
          <code>sd_hash_alg</code> renamed to <code>sd_digest_derivation_alg</code><a href="#appendix-B-7.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.6">Salt/Value Container (SVC) renamed to Issuer-Issued Disclosures (II-Disclosures)<a href="#appendix-B-7.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.7">SD-JWT-Release (SD-JWT-R) renamed to Holder-Selected Disclosures (HS-Disclosures)<a href="#appendix-B-7.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.8">
          <code>sd_disclosure</code> in II-Disclosures renamed to <code>sd_ii_disclosures</code><a href="#appendix-B-7.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.9">
          <code>sd_disclosure</code> in HS-Disclosures renamed to <code>sd_hs_disclosures</code><a href="#appendix-B-7.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.10">clarified relationship between <code>sd_hs_disclosure</code> and SD-JWT<a href="#appendix-B-7.10" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.11">clarified combined formats for issuance and presentation<a href="#appendix-B-7.11" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.12">clarified security requirements for blinded claim names<a href="#appendix-B-7.12" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.13">improved description of Holder Binding security considerations - especially around the usage of "alg=none".<a href="#appendix-B-7.13" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.14">updated examples<a href="#appendix-B-7.14" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.15">text clarifications<a href="#appendix-B-7.15" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.16">fixed <code>cnf</code> structure in examples<a href="#appendix-B-7.16" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-7.17">added feature summary<a href="#appendix-B-7.17" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-8">-00<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-9.1">Upload as draft-ietf-oauth-selective-disclosure-jwt-00<a href="#appendix-B-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-10">[[ pre Working Group Adoption: ]]<a href="#appendix-B-10" class="pilcrow">¶</a></p>
<p id="appendix-B-11">-02<a href="#appendix-B-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-12.1">Added acknowledgements<a href="#appendix-B-12.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-12.2">Improved Security Considerations<a href="#appendix-B-12.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-12.3">Stressed entropy requirements for salts<a href="#appendix-B-12.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-12.4">Python reference implementation clean-up and refactoring<a href="#appendix-B-12.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-12.5">
          <code>hash_alg</code> renamed to <code>sd_hash_alg</code><a href="#appendix-B-12.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-13">-01<a href="#appendix-B-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-14.1">Editorial fixes<a href="#appendix-B-14.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-14.2">Added <code>hash_alg</code> claim<a href="#appendix-B-14.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-14.3">Renamed <code>_sd</code> to <code>sd_digests</code> and <code>sd_release</code><a href="#appendix-B-14.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-14.4">Added descriptions on Holder Binding - more work to do<a href="#appendix-B-14.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-14.5">Clarify that signing the SD-JWT is mandatory<a href="#appendix-B-14.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-B-15">-00<a href="#appendix-B-15" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-16.1">Renamed to SD-JWT (focus on JWT instead of JWS since signature is optional)<a href="#appendix-B-16.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-16.2">Make Holder Binding optional<a href="#appendix-B-16.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-16.3">Rename proof to release, since when there is no signature, the term "proof" can be misleading<a href="#appendix-B-16.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-16.4">Improved the structure of the description<a href="#appendix-B-16.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-16.5">Described verification steps<a href="#appendix-B-16.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-16.6">All examples generated from python demo implementation<a href="#appendix-B-16.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-B-16.7">Examples for structured objects<a href="#appendix-B-16.7" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Fett</span></div>
<div dir="auto" class="left"><span class="org">yes.com</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mail@danielfett.de" class="email">mail@danielfett.de</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://danielfett.de/" class="url">https://danielfett.de/</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kristina Yasuda</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Kristina.Yasuda@microsoft.com" class="email">Kristina.Yasuda@microsoft.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
